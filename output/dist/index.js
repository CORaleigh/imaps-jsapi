define(["exports","esri/WebMap","esri/views/MapView","esri/widgets/Legend","esri/widgets/Print","esri/widgets/Bookmarks","esri/core/accessorSupport/decorators","esri/widgets/support/widget","esri/widgets/Widget","esri/core/Accessor","esri/widgets/Search","esri/widgets/FeatureTable","esri/layers/FeatureLayer","esri/layers/GraphicsLayer","esri/widgets/Feature","esri/Graphic","esri/widgets/FeatureTable/FieldColumnConfig","esri/core/watchUtils","esri/widgets/Search/SearchSource","esri/tasks/support/FeatureSet","esri/widgets/CoordinateConversion","esri/widgets/Expand","esri/widgets/Measurement","esri/widgets/Compass","esri/widgets/Locate","esri/widgets/Track","esri/widgets/Fullscreen","esri/PopupTemplate","esri/popup/content/CustomContent","esri/tasks/Locator","esri/geometry/support/geodesicUtils","esri/Color","esri/widgets/Sketch","esri/symbols/TextSymbol","esri/geometry/geometryEngine","esri/widgets/BasemapGallery","esri/widgets/LayerList","esri/Map"],(function(e,t,i,r,a,o,n,l,s,c,d,u,p,v,f,h,m,y,w,g,b,S,E,A,x,T,D,O,L,I,C,M,P,R,k,q,N,F){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m;var _="default"in y?y.default:y;w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,S=S&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S,E=E&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E,A=A&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,D=D&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D,O=O&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O,L=L&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L,I=I&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I,C=C&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C,M=M&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M,P=P&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P,R=R&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R,k=k&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k,q=q&&Object.prototype.hasOwnProperty.call(q,"default")?q.default:q,N=N&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N,F=F&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F;var B=new t;B=new t({portalItem:{id:"95092428774c4b1fb6a3b6f5fed9fbc4"}});var j="light",W=function(e){var t;document.querySelectorAll("calcite-panel").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-color").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-tip-manager").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-dropdown").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-alert").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-modal").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-block").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-pick-list").forEach((function(t){t.setAttribute("theme",e)})),setTimeout((function(){document.querySelectorAll("calcite-action-bar").forEach((function(t){t.setAttribute("theme",e)}))})),null===(t=document.querySelector("#arrowPath"))||void 0===t||t.setAttribute("stroke","light"===e?"black":"white"),document.querySelectorAll("link").forEach((function(t){t.href.includes("light"===e?"dark":"light")&&(t.href="https://js.arcgis.com/4.18/esri/themes/"+e+"/main.css")}))},U=[{panel:{name:"selectTip",title:"Selection",tips:[{message:"To draw a continuous line or polygon, long press and drag your cursor",title:"Freehand Drawing"},{message:"To draw a continuous line or polygon, long press and drag your cursor",title:"Freehand Drawing"}]}},{panel:{name:"propertySearchTip",title:"Property Search",tips:[{message:"To search by a portion of an owner name or address, hit enter without selecting form the list of suggestions.",title:"Wildcard Search"},{message:"To quickly select a property from the map, long press on a property on the map.",title:"Long Press"},{message:"To select by a location use the property selection tool.",title:"Select By Location"},{message:'Previous "tab" layout has been consolidated into a single scrollable panel.',title:"Single Details Panel"}]}},{panel:{name:"basemapTip",title:"Basemaps",tips:[{message:"The imagery and imagery hybrid base maps listed under the maps tab is a combination of the latest imagery from Raleigh (2019) and from the State of North Carolina (2017).",title:"Imagery Basemaps"}]}}];function G(){document.querySelectorAll(".tip").forEach((function(e){e.addEventListener("click",(function(){var t,i,r,a,o,n,l;null===(t=document.querySelector("calcite-tip-manager"))||void 0===t||t.remove(),null===(r=null===(i=e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r||r.removeAttribute("dismissed"),null===(o=null===(a=e.parentElement)||void 0===a?void 0:a.parentElement)||void 0===o||o.classList.remove("hidden");var s=document.createElement("calcite-tip-manager");s.setAttribute("theme",j);var c=U.find((function(t){return t.panel.name===e.id})),d=document.createElement("calcite-tip-group");d.setAttribute("text-group-title",null===(n=c)||void 0===n?void 0:n.panel.title),s.appendChild(d),null==c||c.panel.tips.forEach((function(e){var t=document.createElement("calcite-tip");t.setAttribute("heading",e.title);var i=document.createElement("p");i.innerHTML=e.message,t.appendChild(i),d.appendChild(t)})),null===(l=null===document||void 0===document?void 0:document.body)||void 0===l||l.appendChild(s)}))}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function J(e,t){function i(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function $(e,t,i,r){var a,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}var H=function(e){function t(t){var i=e.call(this,t)||this;return i.graphics=new v({id:"property-select",listMode:"hide",minScale:19200}),i.singleSymbol={type:"simple-fill",style:"none",outline:{width:2.5,color:[255,82,82,1]},color:[253,46,65,.25]},i.multiSymbol={type:"simple-fill",style:"none",outline:{width:2.5,color:[249,243,0,1]},color:[253,46,65,.25]},i.createFeatureTableLayer=function(e,t){return new p({fields:e,source:t,title:"Selected properties",geometryType:"point",objectIdField:"OBJECTID",spatialReference:i.view.spatialReference})},i.addClusterGraphics=function(e){var t=[];e.features.forEach((function(e){var i=e.clone();i.geometry=i.geometry.centroid,t.push(i)})),i.clusterPoints.queryFeatures({where:"1=1",returnGeometry:!1,outFields:["OBJECTID"]}).then((function(e){i.clusterPoints.applyEdits({deleteFeatures:e.features}).then((function(){i.clusterPoints.applyEdits({addFeatures:t}).then((function(){i.clusterPoints.refresh()}))}))}))},i.addGraphics=function(e){i.graphics.removeAll(),e.features.forEach((function(t){t.symbol=e.features.length>1?i.multiSymbol:i.singleSymbol,i.graphics.add(t)})),i.addClusterGraphics(e)},i.getProperty=function(e,t){var r=i.condosTable.relationships.find((function(e){return"PROPERTY"===e.name}));i.condosTable.queryRelatedFeatures({relationshipId:null==r?void 0:r.id,objectIds:e,outFields:["OBJECTID","REID"],returnGeometry:!1}).then((function(e){var r=[];for(var a in e)e[a].features.forEach((function(e){r.push(e.getAttribute("OBJECTID"))}));i.propertyLayer.queryFeatures({objectIds:r,outFields:["*"],returnGeometry:!0,outSpatialReference:{wkid:102100}}).then((function(e){var r;(null===(r=i.feature)||void 0===r?void 0:r.graphic)&&(i.feature.graphic.geometry=null==e?void 0:e.features[0].geometry),i.view.goTo(e.features),t||i.addGraphics(e)}))}))},i.searchComplete=function(e){var t,r,a;if(i.searchWidget.viewModel.selectedSuggestion){if(e.numResults){var o=e.results[0].source.layer;o||"Owner"!==e.results[0].source.name||(o=i.condosTable),!o&&["Site Address","Street Name"].includes(e.results[0].source.name)&&(o=i.addressTable);var n=[];if(e.results[0].results.forEach((function(e){n.push(e.feature.getObjectId())})),4===o.layerId){var l=o.relationships.find((function(e){return"CONDOS"===e.name}));l&&n&&o.queryRelatedFeatures({relationshipId:l.id,objectIds:n,outFields:["*"]}).then((function(e){var t=[],r=[];for(var a in e)e[a].features.forEach((function(e){t.push(e.getAttribute("OBJECTID")),r.push(e),e.layer=i.condosTable}));i.getProperty(t),r.length>1?(i.feature.graphic=new h,i.toggleContent("table")):(i.setFeature(r[0],i.view,[],t),i.toggleContent("feature")),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,r)}))}else i.condosTable.queryFeatures({objectIds:n,outFields:["*"]}).then((function(e){var t=[];e.features.forEach((function(e){t.push(e.getAttribute("OBJECTID"))})),i.getProperty(t),e.features.length>1?(i.feature.graphic=new h,i.toggleContent("table")):(i.setFeature(e.features[0],i.view,[],t),i.toggleContent("feature")),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,e.features)}))}}else{var s=[],c="";i.searchWidget.activeSource?((null===(t=i.searchWidget.activeSource)||void 0===t?void 0:t.searchFields.includes("OWNER"))&&(c="OWNER like '_%"+e.searchTerm.toUpperCase()+"%'"),(null===(r=i.searchWidget.activeSource)||void 0===r?void 0:r.searchFields.includes("PIN_NUM"))&&(c="PIN_NUM like '%"+e.searchTerm.toUpperCase()+"%'"),(null===(a=i.searchWidget.activeSource)||void 0===a?void 0:a.searchFields.includes("REID"))&&(c="REID like '%"+e.searchTerm.toUpperCase()+"%'")):c="OWNER like '_"+e.searchTerm.toUpperCase()+"%' OR REID like '"+e.searchTerm.toUpperCase()+"%' OR PIN_NUM like '"+e.searchTerm.toUpperCase()+"%'";var d=[];i.condosTable.queryFeatures({where:c,outFields:["*"]}).then((function(t){var r;d=t.features,t.features.forEach((function(e){s.push(e.getObjectId())})),c=!i.searchWidget.activeSource||(null===(r=i.searchWidget.activeSource)||void 0===r?void 0:r.searchFields.includes("ADDRESS"))?"ADDRESS like '%"+e.searchTerm.toUpperCase()+"%'":"ADDRESS IS NULL",i.addressTable.queryFeatures({where:c,outFields:["*"]}).then((function(e){var t=i.addressTable.relationships.find((function(e){return"ADDRESSES"===e.name})),r=[];e.features.forEach((function(e){r.push(e.getObjectId())})),t&&r.length?i.addressTable.queryRelatedFeatures({relationshipId:t.id,objectIds:r,outFields:["*"]}).then((function(e){for(var t in e)e[t].features.forEach((function(e){s.push(e.getAttribute("OBJECTID")),d.push(e)}));i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,d),i.getProperty(s),d.length>1&&(i.feature.graphic=new h,i.toggleContent("table")),i.featureTable.renderNow()})):(i.getProperty(s),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,d),d.length>1&&(i.feature.graphic=new h,i.toggleContent("table")),i.featureTable.renderNow())}))}))}},i.checkSearchParams=function(){var e=new URL(document.location.href).searchParams,t=e.get("reid"),r=e.get("pin"),a="";(t||r)&&(t?a="REID IN ('"+t.split(",").join("','")+"')":r&&(a="PIN_NUM = '"+r+"'"),i.condosTable.queryFeatures({where:a,outFields:["*"]}).then((function(e){var t=[];e.features.forEach((function(e){t.push(e.getAttribute("OBJECTID"))})),i.getProperty(t),e.features.length>1?(i.feature.graphic=new h,i.toggleContent("table")):(i.setFeature(e.features[0],i.view,[],t),i.toggleContent("feature")),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,e.features)})))},i.getSuggestions=function(e,t,i,r,a,o,n){var l=[];return o.forEach((function(t){n?l.push(t+" LIKE '"+e.suggestTerm.toUpperCase()+"%'"):l.push(t+" LIKE '%"+e.suggestTerm.toUpperCase()+"%'")})),i.queryFeatures({returnDistinctValues:!0,outFields:r,returnGeometry:!1,orderByFields:a,where:l.join(" OR ")}).then((function(i){return i.features.map((function(i){return{key:t,text:i.getAttribute(r[0]),sourceIndex:e.sourceIndex}}))}))},i.toggleContent=function(e){var t,i,r,a,o,n,l,s;"table"===e?(null===(t=document.querySelector("#table"))||void 0===t||t.classList.remove("hidden"),null===(i=document.querySelector("#feature"))||void 0===i||i.classList.add("hidden"),null===(r=document.querySelector("#tableItem"))||void 0===r||r.setAttribute("checked",""),null===(a=document.querySelector("#featureItem"))||void 0===a||a.removeAttribute("checked")):(null===(o=document.querySelector("#feature"))||void 0===o||o.classList.remove("hidden"),null===(n=document.querySelector("#table"))||void 0===n||n.classList.add("hidden"),null===(l=document.querySelector("#featureItem"))||void 0===l||l.setAttribute("checked",""),null===(s=document.querySelector("#tableItem"))||void 0===s||s.removeAttribute("checked"))},y.whenDefinedOnce(i,"view",i.init.bind(i)),y.whenDefinedOnce(i,"condosTable",i.initSearch.bind(i)),y.whenDefined(i,"geometry",i.searchByGeometry.bind(i)),i}return J(t,e),t.prototype.searchByGeometry=function(e){var t=this;this.propertyLayer.queryFeatures({geometry:e,returnGeometry:!0,outFields:["OBJECTID","REID"]}).then((function(e){var i=t.propertyLayer.relationships.find((function(e){return"CONDOS"===e.name})),r=[];e.features.forEach((function(e){r.push(e.getObjectId())})),t.propertyLayer.queryRelatedFeatures({relationshipId:null==i?void 0:i.id,objectIds:r,outFields:["*"]}).then((function(i){var r=[];for(var a in i)r=r.concat(i[a].features);1===r.length?(r[0].geometry=e.features[0].geometry,t.setFeature(r[0],t.view,[],[r[0].getAttribute("OBJECTID")]),t.toggleContent("feature")):t.toggleContent("table"),t.graphics.removeAll();var o=new g({features:[]});e.features.forEach((function(i){i.symbol=e.features.length>1?t.multiSymbol:t.singleSymbol,1===e.features.length&&(i.geometry=e.features[0].geometry),t.featureTable.layer=t.createFeatureTableLayer(t.condosTable.fields,r),t.graphics.add(i),o.features.push(i)})),t.addClusterGraphics(o)}))}))},t.prototype.setFeature=function(e,t,i,r){var a=this,o=new URL(document.location.href).searchParams;o.set("reid",e.getAttribute("REID")),window.history.replaceState({},"",location.pathname+"?"+o);var n=this.condosTable.relationships.find((function(e){return"PHOTOS"===e.name})),l=e.getObjectId();i=[],this.condosTable.queryRelatedFeatures({relationshipId:null==n?void 0:n.id,objectIds:r,outFields:["*"]}).then((function(t){var r;for(var o in t)t[o].features.forEach((function(e){i.push({title:"",type:"image",caption:"",value:{sourceURL:"https://services.wakegov.com/realestate/photos/mvideo/"+e.getAttribute("PHOTO")}})}));var n=a.condosTable.popupTemplate.content.find((function(e){return"media"===(null==e?void 0:e.type)}));n&&(n.mediaInfos=i),e.layer=a.condosTable,e.popupTemplate=e.layer.popupTemplate,a.feature.graphic=e,null===(r=document.querySelector("#featureDiv"))||void 0===r||r.scrollTo({top:0,behavior:"smooth"}),a.feature.graphic.symbol=a.singleSymbol,a.feature.graphic.setAttribute("OBJECTID",l);var s=a.graphics.graphics.find((function(e){return"true"===e.getAttribute("selected")}));s&&(s.symbol=a.multiSymbol,s.setAttribute("selected","false"));var c=a.graphics.graphics.find((function(t){return t.getAttribute("REID")===e.getAttribute("REID")}));c&&(c.symbol=a.singleSymbol,c.setAttribute("selected","true"),a.graphics.graphics.reorder(c,a.graphics.graphics.length-1))}))},t.prototype.exportTable=function(){this.featureTable.layer.queryFeatures({outFields:["*"]}).then((function(e){var t="";e.fields.forEach((function(e){t+=e.alias+","})),t+="\r\n",e.features.forEach((function(e){for(var i in e.attributes)i.toLowerCase().includes("date")?t+='"'+new Date(e.attributes[i]).toDateString()+'",':i.toLowerCase().includes("acres")?t+='"'+parseFloat(e.attributes[i]).toFixed(2)+'",':t+='"'+e.attributes[i]+'",';t+="\r\n"}));var i=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){var a=URL.createObjectURL(i);r.setAttribute("href",a),r.setAttribute("download","imaps_export.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}))},t.prototype.init=function(e){e.map.add(this.graphics,e.map.allLayers.length-1),this.clusterPoints=new p({source:[],objectIdField:"OBJECTID",geometryType:"point",maxScale:19201,listMode:"hide",legendEnabled:!1,renderer:{type:"simple",symbol:{type:"simple-marker",size:4,color:"#69dcff",outline:{color:"rgba(0, 139, 174, 0.5)",width:5}}},featureReduction:{type:"cluster",labelingInfo:[{deconflictionStrategy:"none",labelExpressionInfo:{expression:"Text($feature.cluster_count, '#,###')"},symbol:{type:"text",color:"#004a5d",font:{weight:"bold",family:"Noto Sans",size:"12px"}},labelPlacement:"center-center"}]},spatialReference:this.view.spatialReference}),this.view.map.add(this.clusterPoints),this.checkSearchParams()},t.prototype.initSearch=function(){var e,t,i,r=this,a=new p({fields:[{name:"SITE_ADDRESS",type:"string",alias:"Address"},{name:"OWNER",type:"string",alias:"Owner"},{name:"PIN_NUM",type:"string",alias:"PIN"},{name:"REID",type:"string",alias:"REID"}],source:[],title:"Selected properties",geometryType:"point",objectIdField:"OBJECTID",spatialReference:this.view.spatialReference});this.feature=new f({view:this.view}),this.featureTable=new u({view:this.view,layer:a,fieldConfigs:[new m({name:"SITE_ADDRESS",label:"Address",editable:!1,required:!0}),new m({name:"OWNER",label:"Owner",editable:!1,required:!0}),new m({name:"PIN_NUM",label:"PIN",editable:!1,required:!0}),new m({name:"REID",label:"REID",editable:!1,required:!0})],menuConfig:{items:[{label:"Export"}]}}),this.featureTable.watch("viewModel.state",(function(e){var t,i;if("ready"===e){var r=document.createElement("style");r.append(document.createTextNode('td, th, table { background-color: #353535 !important;color: #fff;} td[role="gridcell"],th[role="columnheader"]{border-color: white !important;}')),null===(i=null===(t=null===document||void 0===document?void 0:document.querySelector(".esri-feature-table .esri-grid__grid"))||void 0===t?void 0:t.shadowRoot)||void 0===i||i.append(r)}}));var o=null===(i=null===(t=null===(e=this.featureTable)||void 0===e?void 0:e.menuConfig)||void 0===t?void 0:t.items)||void 0===i?void 0:i.find((function(e){return"Export"===e.label}));o.clickFunction=function(){r.exportTable()},o.clickFunction.bind(this.featureTable),this.featureTable.on("selection-change",(function(e){r.featureTable.clearSelection(),e.added.length&&(r.getProperty([e.added[0].feature.getAttribute("OBJECTID")],"table"),r.setFeature(e.added[0].feature,r.view,[],[e.added[0].feature.getAttribute("OBJECTID")]),e.added[0].feature.setAttribute("selected","true"),r.toggleContent("feature"))})),this.searchWidget=new d({allPlaceholder:"Address, owner, PIN, or REID",includeDefaultSources:!1,container:"search",sources:[new w({placeholder:"example: 222 W HARGETT ST",name:"Site Address",getSuggestions:function(e){return r.getSuggestions(e,"Site Address",r.addressTable,["ADDRESS"],["ADDRESS"],["ADDRESS"],!0)},getResults:function(e){return r.addressTable.queryFeatures({where:"ADDRESS = '"+e.suggestResult.text.toUpperCase()+"'",outFields:["ADDRESS","REID","OBJECTID"]}).then((function(e){return e.features.map((function(e){return{feature:e,name:"Address"}}))}))}}),new w({placeholder:"example: SMITH, JOHN",name:"Owner",getSuggestions:function(e){return r.getSuggestions(e,"Owner",r.condosTable,["OWNER"],["OWNER"],["OWNER"],!1)},getResults:function(e){return r.condosTable.queryFeatures({where:"OWNER = '"+e.suggestResult.text.toUpperCase()+"'",outFields:["OWNER","OBJECTID"]}).then((function(e){return e.features.map((function(e){return{feature:e,name:"Owner"}}))}))}}),new w({placeholder:"PIN",name:"PIN",getSuggestions:function(e){return r.getSuggestions(e,"PIN",r.condosTable,["PIN_NUM"],["PIN_NUM"],["PIN_NUM"],!0)},getResults:function(e){return r.condosTable.queryFeatures({where:"PIN_NUM = '"+e.suggestResult.text+"'",outFields:["PIN_NUM","OBJECTID"]}).then((function(e){return e.features.map((function(e){return{feature:e,name:"PIN"}}))}))}}),new w({placeholder:"REID",name:"REID",getSuggestions:function(e){return r.getSuggestions(e,"REID",r.condosTable,["REID"],["REID"],["REID"],!0)},getResults:function(e){return r.condosTable.queryFeatures({where:"REID = '"+e.suggestResult.text+"'",outFields:["REID","OBJECTID"]}).then((function(e){return e.features.map((function(e){return{feature:e,name:"REID"}}))}))}}),new w({placeholder:"example: W HARGETT ST",name:"Street Name",getSuggestions:function(e){return r.getSuggestions(e,"Street Name",r.addressTable,["STREET","ADDR_LIST"],["STREET"],["STREET","STREET_NODIR"],!1)},getResults:function(e){return r.addressTable.queryFeatures({where:"STREET = '"+e.suggestResult.text.toUpperCase()+"'",outFields:["STREET","REID","OBJECTID"]}).then((function(e){return e.features.map((function(e){return{feature:e,name:"Street Name"}}))}))}})]}),this.searchWidget.on("search-complete",this.searchComplete)},$([n.property()],t.prototype,"view",void 0),$([n.property()],t.prototype,"condosTable",void 0),$([n.property()],t.prototype,"addressTable",void 0),$([n.property()],t.prototype,"propertyLayer",void 0),$([n.property()],t.prototype,"searchWidget",void 0),$([n.property()],t.prototype,"featureTable",void 0),$([n.property()],t.prototype,"feature",void 0),$([n.property()],t.prototype,"geometry",void 0),t=$([n.subclass("app.widgets.PropertySearch.PropertySearchViewModel")],t)}(c),z="esri-widget propertysearch-base",Y=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new H,i._createSearch=function(){i.searchWidget&&(i.searchWidget.container="search")},i._createTable=function(){i.featureTable&&(i.featureTable.container="table")},i._createFeature=function(){i.feature&&(i.feature.container="featureDiv")},i.currentRadioButton="list",i}return J(t,e),t.prototype.render=function(){var e,t,i=this;document.querySelectorAll("#sideDiv calcite-radio-group-item").forEach((function(e){null==e||e.addEventListener("calciteRadioGroupItemChange",(function(e){var t,r;(null===(t=e.target)||void 0===t?void 0:t.checked)&&i.viewModel.toggleContent(null===(r=e.target)||void 0===r?void 0:r.value)}))}));var r=document.querySelector("#featureDiv");null===(e=document.querySelector("#scrollArrow"))||void 0===e||e.addEventListener("click",(function(){null==r||r.scrollBy({top:r.offsetHeight,behavior:"smooth"})}));var a=window.localStorage.getItem("theme");return a&&(null===(t=document.querySelector("#arrowPath"))||void 0===t||t.setAttribute("stroke","light"===a?"black":"white")),null==r||r.addEventListener("scroll",(function(){var e,t;r.scrollTop>=r.scrollHeight-r.offsetHeight-1?null===(e=document.querySelector("#scrollArrow"))||void 0===e||e.classList.add("hidden"):null===(t=document.querySelector("#scrollArrow"))||void 0===t||t.classList.remove("hidden")})),l.tsx("div",{class:z},l.tsx("div",{afterCreate:this._createSearch,id:"search"}),l.tsx("div",{afterCreate:this._createTable,id:"table"}),l.tsx("div",{id:"feature",class:"hidden"},l.tsx("div",{id:"featureDiv",afterCreate:this._createFeature}),l.tsx("div",{id:"scrollArrow",class:"home-page__scroll-down-arrow home-page__scroll-down-arrow--black","data-dojo-attach-point":"arrowContainer"},l.tsx("svg",{viewBox:"0 0 32 32",width:"32",height:"32",class:"icon-inline  "},l.tsx("path",{id:"arrowPath",stroke:"black","stroke-opacity":"0.5",d:"M16.5 27.207l-4.854-4.854.707-.707L16 25.293V5h1v20.293l3.646-3.646.707.707z"})))),l.tsx("calcite-radio-group",{width:"full"},l.tsx("calcite-radio-group-item",{checked:!0,value:"table",id:"tableItem"},"List"),l.tsx("calcite-radio-group-item",{value:"feature",id:"featureItem",disabled:!0},"Details")))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.condosTable")],t.prototype,"condosTable",void 0),$([n.aliasOf("viewModel.addressTable")],t.prototype,"addressTable",void 0),$([n.aliasOf("viewModel.propertyLayer")],t.prototype,"propertyLayer",void 0),$([n.aliasOf("viewModel.searchWidget")],t.prototype,"searchWidget",void 0),$([n.aliasOf("viewModel.featureTable")],t.prototype,"featureTable",void 0),$([n.aliasOf("viewModel.feature")],t.prototype,"feature",void 0),$([n.aliasOf("viewModel.geometry")],t.prototype,"geometry",void 0),$([n.property({type:H}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.PropertySearch")],t)}(s),K=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){this.measurement=new E({view:e,areaUnit:"square-feet",linearUnit:"feet"}),this.measurement.watch("activeTool",(function(e){e||document.querySelectorAll(".measure-base calcite-radio-group-item").forEach((function(e){"clear"===e.value?e.setAttribute("checked",""):e.removeAttribute("checked")}))}))},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.Measure.MeasureViewModel")],t)}(c),Z="esri-widget measure-base",X=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new K,i._measureCreated=function(){i.measurement&&(i.measurement.container="measureWidget")},i}return J(t,e),t.prototype.render=function(){var e=this;return document.querySelectorAll("#measureDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r;t.target.hasAttribute("checked")||("clear"===(null===(i=t.target)||void 0===i?void 0:i.title)?e.measurement.clear():e.measurement.activeTool=null===(r=t.target)||void 0===r?void 0:r.title)}))})),l.tsx("div",{class:Z},l.tsx("calcite-radio-group",{width:"full"},l.tsx("calcite-radio-group-item",{title:"distance",value:"distance",id:"distanceItem",icon:"measure"},"Distance"),l.tsx("calcite-radio-group-item",{title:"area",value:"area",id:"areaItem",icon:"measure-area"},"Area"),l.tsx("calcite-radio-group-item",{title:"clear",value:"clear",id:"clearItem",icon:"trash"},"Clear")),l.tsx("div",{afterCreate:this._measureCreated,id:"measureWidget"}))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.measurement")],t.prototype,"measurement",void 0),$([n.property({type:K}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.Measure")],t)}(s),Q=[{name:"mailing-address",title:"mailing-address",expression:"When(IsEmpty($feature.ADDR3),$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2,$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2 + TextFormatting.NewLine + $feature.ADDR3)"},{name:"property-values",title:"property-values",expression:'"Building Value"+TextFormatting.NewLine+"$"+$feature.BLDG_VAL+TextFormatting.NewLine+"Land Value"+TextFormatting.NewLine+"$"+$feature.LAND_VAL+TextFormatting.NewLine+"Total Value"+TextFormatting.NewLine+"$"+$feature.TOTAL_VALUE_ASSD'},{name:"pin",title:"PIN",expression:"var num = $feature.PIN_NUM;var ext = $feature.PIN_EXT;return When(ext == '000',num,num+' '+ext);"},{name:"build_val",title:"Building Value",expression:"var value = $feature.BLDG_VAL;When(IsEmpty(value),'--', '$'+Text(value, '#,###'));"},{name:"land_val",title:"Land Value",expression:"var value = $feature.LAND_VAL;When(IsEmpty(value),'--', '$'+Text(value, '#,###'));"},{name:"total_val",title:"Total Value",expression:"var value = $feature.TOTAL_VALUE_ASSD;When(IsEmpty(value),'--', '$'+Text(value, '#,###'));"},{name:"sale_price",title:"Sale Price",expression:"var value = $feature.TOTSALPRICE;When(IsEmpty(value),'--', '$'+Text(value, '#,###'));"},{name:"city",title:"City",expression:"var city = $feature.CITY_DECODE;When(IsEmpty(city),'Unincorporated', Proper(city));"},{name:"township",title:"Township",expression:"var ts = $feature.TOWNSHIP_DECODE;When(IsEmpty(ts),'None', Proper(ts));"},{name:"jurisdiction",title:"Jurisdiction",expression:"var juris = $feature.PLANNING_JURISDICTION;When(juris == 'RA', 'Raleigh',juris == 'CA', 'Cary',juris == 'AP', 'Apex',juris == 'AN', 'Angier',juris == 'CL', 'Clayton',juris == 'DU', 'Durham',juris == 'FV', 'Fuquay-Varina',juris == 'GA', 'Garner',juris == 'HS', 'Holly Springs',juris == 'KN', 'Knightdale',juris == 'MO', 'Morrisville',juris == 'RO', 'Rolesville',juris == 'WF', 'Wake Forest',juris == 'WE', 'Wendell',juris == 'ZB', 'Zebulon',juris == 'WC', 'Wake County', 'Wake County');"},{name:"general",title:"general",expression:'"PIN"+TextFormatting.NewLine+$feature.PIN_NUM+" "+$feature.PIN_EXT+TextFormatting.NewLine+"REID"+TextFormatting.NewLine+$feature.REID+TextFormatting.NewLine+"City"+TextFormatting.NewLine+Proper($feature.CITY_DECODE)+TextFormatting.NewLine+"Jurisdiction"+TextFormatting.NewLine+$feature.PLANNING_JURISDICTION+TextFormatting.NewLine+"Township"+TextFormatting.NewLine+Proper($feature.TOWNSHIP_DECODE)'},{name:"addresses",title:"Addresses",expression:"var rel = FeatureSetByRelationshipName($feature, 'PROPERTY', ['*'], true);var test = Array(Count(rel));var cnt = 0;var f = First(rel);var fs = FeatureSetByPortalItem(Portal('https://ral.maps.arcgis.com/'), '318be24592ea4dcba042511b3125fd53', 2, ['ADDRESS','FEATURETYPE']);var containfs = Contains(f, fs);var addresses = Array(Count(containfs));var cnt = 0;for (var i in containfs){        addresses[cnt] = {'ADDRESS': i['ADDRESS'], 'FEATURETYPE': i['FEATURETYPE']};    cnt+=1;}function sortAddresses(a,b) {    return  a['ADDRESS'] > b['ADDRESS'];}var sorted =  Sort(addresses, sortAddresses);var list = '';for (var i in sorted) {    list += sorted[i]['ADDRESS'] + ' (' + sorted[i]['FEATURETYPE'] + ')' + TextFormatting.NewLine;}return list;"}],ee=[{group:{title:"Electoral",layers:["Precincts","Congressional Districts","NC House of Representatives Districts","NC Senate Districts","School Board Districts","Board of Commissioners Districts","Superior Court Districts","Raleigh City Council","Morrisville Town Council Districts"]}},{group:{title:"Environmental",layers:["Special Flood Hazard Areas - FloodPlain - Floodplain","Soils","Critical Watersheds","Water Supply Watersheds"]}}],te=function(e){var t=e.detail.requestedAccordionItem.getBoundingClientRect(),i=document.querySelector("#featureDiv");setTimeout((function(){null==i||i.scrollTo({top:t.top+i.scrollTop-155,behavior:"smooth"})}),500)},ie=function(e){var t;return e.graphic.layer.queryRelatedFeatures({relationshipId:null===(t=e.graphic.layer.relationships.find((function(e){return"BOOKS"===e.name})))||void 0===t?void 0:t.id,objectIds:[e.graphic.getObjectId()],outFields:["BOM_DOC_NUM","DEED_DOC_NUM"]}).then((function(t){var i=t[e.graphic.getObjectId()].features[0].getAttribute("DEED_DOC_NUM"),r=t[e.graphic.getObjectId()].features[0].getAttribute("BOM_DOC_NUM"),a=document.createElement("div");if(a.setAttribute("style","display: flex;flex-direction: row;"),i){var o=document.createElement("calcite-button");o.setAttribute("scale","s"),o.setAttribute("target","_blank"),o.setAttribute("round",""),o.setAttribute("icon-start","file-text"),o.setAttribute("href","http://services.wakegov.com/booksweb/pdfview.aspx?docid="+i+"&RecordDate="),o.textContent="Deed",a.append(o)}if(r){var n=document.createElement("calcite-button");n.setAttribute("scale","s"),n.setAttribute("target","_blank"),n.setAttribute("round",""),n.setAttribute("icon-start","map"),n.setAttribute("href","http://services.wakegov.com/booksweb/pdfview.aspx?docid="+r+"&RecordDate="),n.textContent="Book of Maps",a.append(n)}return a}))},re=new p({portalItem:{id:"d3d02d5e35324b769469b99121c0e996"},spatialReference:{wkid:102100}}),ae=new p({portalItem:{id:"d3d02d5e35324b769469b99121c0e996"},layerId:1,spatialReference:{wkid:102100}});ae.load();var oe=new p({portalItem:{id:"d3d02d5e35324b769469b99121c0e996"},layerId:4,spatialReference:{wkid:102100}});oe.load();var ne,le,se,ce,de,ue,pe,ve,fe,he=function(e){var t=new O({expressionInfos:Q,content:[{type:"text",text:"<h1>{SITE_ADDRESS}</h1>"},new L({outFields:["*"],creator:function(e){return new I({url:"https://maps.raleighnc.gov/arcgis/rest/services/Locators/CompositeLocator/GeocodeServer",outSpatialReference:{wkid:4326}}).addressToLocations({address:{singleLine:e.graphic.getAttribute("SITE_ADDRESS")},outFields:["*"]}).then((function(t){var i;if(t.length){var r=t.find((function(e){return"WakeStreets"===e.attributes.Loc_name}));if(r){var a=C.geodesicDistance(r.location,{x:e.graphic.geometry.centroid.longitude,y:e.graphic.geometry.centroid.latitude,spatialReference:{wkid:4326}}),o=e.graphic.geometry.centroid.latitude+","+e.graphic.geometry.centroid.longitude,n=document.createElement("div");n.setAttribute("style","display: flex;flex-direction: row;");var l=document.createElement("calcite-button");l.setAttribute("scale","s"),l.setAttribute("target","_blank"),l.setAttribute("round",""),l.setAttribute("icon-start","person"),l.setAttribute("href","https://maps.google.com?layer=c&cbll="+o+"&cbp=0,"+(null===(i=a.azimuth)||void 0===i?void 0:i.toString())+",0,0,0"),l.textContent="Street View",n.append(l);var s=document.createElement("calcite-button");return s.setAttribute("scale","s"),s.setAttribute("target","_blank"),s.setAttribute("href","http://services.wakegov.com/realestate/Account.asp?id="+e.graphic.getAttribute("REID")),s.setAttribute("round",""),s.setAttribute("icon-start","locator"),s.textContent="Tax Page",n.append(s),n}}}))}}),{type:"text",text:"<h2>General</h1>"},{type:"fields",fieldInfos:[{fieldName:"expression/pin",label:"PIN"},{fieldName:"REID",label:"REID"},{fieldName:"expression/city",label:"City"},{fieldName:"expression/jurisdiction",label:"Jurisdiction"},{fieldName:"expression/township",label:"Township"}]},{type:"text",text:"<h2>Owner</h1>"},{type:"text",text:"{OWNER}<br/>{expression/mailing-address}"},{type:"text",text:"<h2>Valuation</h1>"},{type:"fields",fieldInfos:[{fieldName:"expression/build_val"},{fieldName:"expression/land_val"},{fieldName:"expression/total_val"},{fieldName:"BILLING_CLASS_DECODE",label:"Billing Class"}]},{type:"text",text:"<h2>Last Sale</h1>"},{type:"fields",fieldInfos:[{fieldName:"SALE_DATE",format:{dateFormat:"short-date"},label:"Date Sold"},{fieldName:"expression/sale_price"}]},{type:"text",text:"<h2>Deeds</h1>"},{type:"fields",fieldInfos:[{fieldName:"DEED_BOOK",label:"Book"},{fieldName:"DEED_PAGE",label:"Page"},{fieldName:"DEED_DATE",format:{dateFormat:"short-date"},label:"Deed Date"},{fieldName:"DEED_ACRES",format:{places:2},label:"Deed Acres"},{fieldName:"PROPDESC",label:"Legal Description"}]},new L({outFields:["OBJECTID","REID"],creator:ie}),{type:"text",text:"<h2>Building</h1>"},{type:"fields",fieldInfos:[{fieldName:"HEATEDAREA",format:{digitSeparator:!0},label:"Heated Area"},{fieldName:"YEAR_BUILT",format:{digitSeparator:!1},label:"Year Built"},{fieldName:"DESIGN_STYLE_DECODE",label:"Design/Style"},{fieldName:"TOTSTRUCTS",label:"Total Structures"},{fieldName:"TOTUNITS",label:"Total Units"}]},{type:"media",mediaInfos:[]},{type:"text",text:"<h2>Services</h1>"},new L({outFields:["*"],creator:function(t){var i=document.createElement("calcite-accordion");i.setAttribute("selection-mode","single"),ee.forEach((function(e){var t=document.createElement("calcite-accordion-item");t.setAttribute("item-title",e.group.title),i.append(t)}));var r=t.graphic;return i.addEventListener("calciteAccordionChange",(function(t){!function(e,t,i){if(!i.detail.requestedAccordionItem.hasAttribute("active")&&0===i.detail.requestedAccordionItem.childElementCount){var r=document.createElement("calcite-loader");r.setAttribute("inline","");var a=i.detail.requestedAccordionItem.shadowRoot.querySelector(".accordion-item-header");a.insertBefore(r,a.childNodes[1]);var o=ee.find((function(e){return e.group.title===i.detail.requestedAccordionItem.getAttribute("item-title")})),n=[];if(o)t.map.allLayers.filter((function(e){return o.group.layers.includes(e.title)})).forEach((function(t){n.push(t.queryFeatures({geometry:e.geometry,outFields:["*"],returnGeometry:!0}))}));return n.length?Promise.all(n).then((function(e){e.forEach((function(e){e.features.length&&e.features.forEach((function(e){var t=document.createElement("div");i.detail.requestedAccordionItem.append(t),new f({container:t,graphic:e})}))})),te(i),a.removeChild(r)})):(a.removeChild(r),"No services found.")}te(i)}(r,e,t)})),i}}),{type:"text",text:"<h2>Addresses</h1>"},{type:"text",text:"{expression/addresses}"}]});ae.popupTemplate=t},me=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.initDraw=function(){var e=this;this.graphics=new v({listMode:"hide"}),this.view.map.add(this.graphics),this.sketch=new P({view:this.view,container:"sketchDiv",layer:this.graphics,creationMode:"single",defaultCreateOptions:{mode:"hybrid"}}),this.sketch.viewModel.pointSymbol.color=M.fromHex("#FF0000"),this.sketch.viewModel.pointSymbol.outline.color=M.fromHex("#FF0000"),this.sketch.viewModel.polygonSymbol.color=new M([[255,0,0,.5]]),this.sketch.viewModel.polygonSymbol.outline.color=M.fromHex("#FF0000"),this.sketch.viewModel.polylineSymbol.color=M.fromHex("#FF0000"),this.sketch.watch("activeTool",(function(t){var i;null!=t&&(null===(i=e.measurement)||void 0===i||i.clear())})),this.sketch.on("create",(function(t){var i,r;if("start"===t.state&&(null===(i=e.measurement)||void 0===i||i.clear()),"complete"===t.state&&(null===(r=e.label)||void 0===r?void 0:r.length)){var a=t.graphic.geometry;"polygon"===t.graphic.geometry.type&&(a=t.graphic.geometry.centroid);var o=new h({geometry:a,symbol:new R({text:e.label,color:e.textColor,haloColor:"white",haloSize:1,xoffset:"5px",yoffset:"5px",verticalAlignment:"bottom",horizontalAlignment:"right"})});e.graphics.add(o)}}))},t.prototype.init=function(e){console.log(e.scale)},$([n.property()],t.prototype,"view",void 0),$([n.property()],t.prototype,"container",void 0),t=$([n.subclass("app.widgets.Draw.DrawViewModel")],t)}(c),ye="esri-widget draw-base",we=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new me,i._drawUpdated=function(){i.viewModel.sketch||i.viewModel.initDraw()},i}return J(t,e),t.prototype.render=function(){var e=this,t=document.querySelector("#fill");null==t||t.setAttribute("value","#ff0000"),null==t||t.addEventListener("calciteColorChange",(function(t){var i=t.target.value;e.viewModel.sketch.viewModel.pointSymbol.color=M.fromHex(i),e.viewModel.sketch.viewModel.polygonSymbol.color=M.fromHex(i)}));var i=document.querySelector("#line");null==i||i.setAttribute("value","#ff0000"),null==i||i.addEventListener("calciteColorChange",(function(t){var i=t.target.value;e.viewModel.sketch.viewModel.polylineSymbol.color=M.fromHex(i),e.viewModel.sketch.viewModel.pointSymbol.outline.color=M.fromHex(i),e.viewModel.sketch.viewModel.polygonSymbol.outline.color=M.fromHex(i)}));var r=document.querySelector("#opacity");null==r||r.addEventListener("calciteSliderUpdate",(function(t){e.viewModel.sketch.viewModel.polygonSymbol.color.a=t.target.value}));var a=document.querySelector("#width");null==a||a.addEventListener("calciteSliderUpdate",(function(t){e.viewModel.sketch.viewModel.polylineSymbol.width=parseFloat(t.target.value),e.viewModel.sketch.viewModel.pointSymbol.outline.width=parseFloat(t.target.value),e.viewModel.sketch.viewModel.polygonSymbol.outline.width=parseFloat(t.target.value)}));var o=document.querySelector("#label");null==o||o.addEventListener("calciteInputBlur",(function(t){e.set("label",t.target.value)}));var n=document.querySelector("#textColor");return null==n||n.setAttribute("value","#ff0000"),null==n||n.addEventListener("calciteColorChange",(function(t){e.set("textColor",M.fromHex(t.target.value))})),l.tsx("div",{class:ye},l.tsx("div",{afterUpdate:this._drawUpdated,id:"sketchDiv"}),l.tsx("calcite-block",{heading:"Settings",open:!0,collapsible:!0},l.tsx("calcite-block-section",{text:"Color"},l.tsx("calcite-label",{scale:"s"},"Fill Color ",l.tsx("calcite-color",{id:"fill",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"})),l.tsx("calcite-label",{scale:"s"},"Line Color ",l.tsx("calcite-color",{id:"line",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"}))),l.tsx("calcite-block-section",{text:"Fill Opacity"},l.tsx("calcite-label",{scale:"s"},"Opacity",l.tsx("calcite-slider",{scale:"s",id:"opacity",max:"1",min:"0",value:"0.5",step:"0.1"}))),l.tsx("calcite-block-section",{text:"Outline"},l.tsx("calcite-label",{scale:"s"},"Width ",l.tsx("calcite-slider",{id:"width",max:"10",min:"0",value:"1",step:"0.5"}))),l.tsx("calcite-block-section",{text:"Labeling"},l.tsx("calcite-label",{scale:"s"},"Label ",l.tsx("calcite-input",{scale:"s",id:"label",type:"textarea"})),l.tsx("calcite-label",{scale:"s"},"Text Color",l.tsx("calcite-color",{id:"textColor",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"})))))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.label")],t.prototype,"label",void 0),$([n.aliasOf("viewModel.textColor")],t.prototype,"textColor",void 0),$([n.aliasOf("viewModel.measurement")],t.prototype,"measurement",void 0),$([n.property({type:me}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.Draw")],t)}(s),ge=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),y.whenDefinedOnce(i,"sketch",i.initSketch.bind(i)),i}return J(t,e),t.prototype.initSketch=function(){var e=this;this.graphics=new v({listMode:"hide"}),this.view.map.add(this.graphics),this.sketch=new P({view:this.view,container:"selectWidget",layer:this.graphics,creationMode:"single",defaultCreateOptions:{mode:"hybrid"}}),this.sketch.viewModel.updateOnGraphicClick=!1,this.sketch.on("create",(function(t){var i;if("complete"===t.state)if(e.graphics.removeAll(),e.bufferDistance>0){var r=k.geodesicBuffer(t.graphic.geometry,e.bufferDistance,"feet");t.graphic.geometry=r,e.graphics.add(t.graphic),t.graphic.symbol={type:"simple-fill",style:"none",outline:{style:"short-dash",width:2.5,color:[221,221,221,1]},color:new M([255,243,13,.25])},e.geometry=t.graphic.geometry,e.view.goTo(t.graphic)}else e.geometry=t.graphic.geometry;"start"===t.state&&(null===(i=e.measurement)||void 0===i||i.clear())})),this.sketch.watch("activeTool",(function(t){var i;null!=t&&(null===(i=e.measurement)||void 0===i||i.clear())}))},t.prototype.init=function(){this.set("bufferDistance",0)},$([n.property()],t.prototype,"view",void 0),$([n.property()],t.prototype,"layer",void 0),$([n.property()],t.prototype,"geometry",void 0),t=$([n.subclass("app.widgets.Select.SelectViewModel")],t)}(c),be="esri-widget select-base",Se=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new ge,i._sketchCreated=function(){i.viewModel.sketch||i.viewModel.initSketch()},i}return J(t,e),t.prototype.handleChange=function(e){this.set("bufferDistance",parseInt(e.target.value))},t.prototype.render=function(){var e,t=this;return null===(e=document.querySelector("#selectDiv calcite-input"))||void 0===e||e.addEventListener("calciteInputBlur",(function(e){t.handleChange(e)})),l.tsx("div",{class:be},l.tsx("div",{afterUpdate:this._sketchCreated,id:"selectWidget"}),l.tsx("calcite-label",{scale:"s"},"Buffer Distance (feet)",l.tsx("calcite-input",{scale:"s",type:"number",min:"0",max:"2000",step:"50",value:this.viewModel.bufferDistance})))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.layer")],t.prototype,"layer",void 0),$([n.aliasOf("viewModel.sketch")],t.prototype,"sketch",void 0),$([n.aliasOf("viewModel.bufferDistance")],t.prototype,"bufferDistance",void 0),$([n.aliasOf("viewModel.measurement")],t.prototype,"measurement",void 0),$([n.property({type:ge}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.Select")],t)}(s),Ee=function(e){function t(t){var i=e.call(this,t)||this;return i.changePropertyLines=function(e){var t=i.view.map.allLayers.find((function(e){return"feature"===e.type&&"Property"===e.title})),r=t.renderer.clone();e.title.toLowerCase().includes("dark")||e.title.toLowerCase().includes("night")||e.title.toLowerCase().includes("dark")||e.title.toLowerCase().startsWith("20")||e.title.toLowerCase().startsWith("19")?r.symbol.outline.color=new M([255,255,255,.5]):r.symbol.outline.color=new M([0,0,0,.5]),t.renderer=r},i.toggleContent=function(e){var t,i,r,a,o,n,l,s,c,d,u;"maps"===e?(null===(t=document.querySelector("#maps"))||void 0===t||t.classList.remove("hidden"),null===(i=document.querySelector("#images"))||void 0===i||i.classList.add("hidden"),null===(r=document.querySelector("#mapsItem"))||void 0===r||r.setAttribute("checked",""),null===(a=document.querySelector("#imagesItem"))||void 0===a||a.removeAttribute("checked"),null===(o=document.querySelector("#blend"))||void 0===o||o.classList.add("hidden"),null===(n=document.querySelector("#blendSlider"))||void 0===n||n.classList.add("hidden")):(null===(l=document.querySelector("#images"))||void 0===l||l.classList.remove("hidden"),null===(s=document.querySelector("#maps"))||void 0===s||s.classList.add("hidden"),null===(c=document.querySelector("#imagesItem"))||void 0===c||c.setAttribute("checked",""),null===(d=document.querySelector("#mapsItem"))||void 0===d||d.removeAttribute("checked"),null===(u=document.querySelector("#blend"))||void 0===u||u.classList.remove("hidden"))},y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){var t=this;this.basemaps=new q({view:this.view}),this.view.when((function(){t.changePropertyLines(t.view.map.basemap)})),this.view.map.watch("basemap",(function(e){var i,r,a;t.changePropertyLines(e),(null===(i=document.querySelector("#images"))||void 0===i?void 0:i.classList.contains("hidden"))&&(t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))})),t.activeBasemap=t.view.map.basemap,null===(r=document.querySelector("#blendSwitch"))||void 0===r||r.removeAttribute("switched")),t.images.viewModel.items.find((function(e){return e.basemap.title===t.view.map.basemap.title}))&&(null===(a=document.querySelector("#blendSwitch"))||void 0===a?void 0:a.hasAttribute("switched"))?t.view.map.addMany(t.activeBasemap.baseLayers.toArray()):t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))}))})),this.activeBasemap=this.view.map.basemap,this.images=new q({view:this.view,source:{query:{id:"492386759d264d49948bf7f83957ddb9"}}}),window.addEventListener("pagehide",(function(){t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))}));var i=e.map.toJSON();i.initialState.viewpoint.targetGeometry=e.extent,window.localStorage.setItem("imaps",JSON.stringify(i))}))},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.BaseMaps.BaseMapsViewModel")],t)}(c),Ae="esri-widget basemaps-base",xe=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new Ee,i._createMaps=function(){i.basemaps&&(i.basemaps.container="maps")},i._createImages=function(){i.images&&(i.images.container="images")},i.handleSwitchChange=function(e){var t,r;""!=e.target.getAttribute("switched")?(null===(t=document.querySelector("#blendSlider"))||void 0===t||t.classList.remove("hidden"),i.view.map.addMany(i.viewModel.activeBasemap.baseLayers.toArray(),0),i.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!1})),i.view.map.layers.filter((function(e){return i.viewModel.activeBasemap.baseLayers.includes(e)})).forEach((function(e){e.opacity=.5,e.visible=!0}))):(null===(r=document.querySelector("#blendSlider"))||void 0===r||r.classList.add("hidden"),i.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!0})),i.viewModel.activeBasemap.baseLayers.forEach((function(e){i.view.map.remove(i.view.map.findLayerById(e.id))})))},i.handleSliderChange=function(e){i.view.map.layers.filter((function(e){var t;return null===(t=i.viewModel.activeBasemap)||void 0===t?void 0:t.baseLayers.includes(e)})).toArray().forEach((function(t){t.opacity=parseFloat(e.target.getAttribute("value"))}))},i._sliderCreated=function(e){var t;null===(t=document.querySelector("#blendSlider"))||void 0===t||t.addEventListener("calciteSliderUpdate",i.handleSliderChange.bind({basemap:i.basemaps,view:i.view}))},i._blendCreated=function(e){var t,r;null===(t=document.querySelector("#blendSwitch"))||void 0===t||t.addEventListener("calciteSwitchChange",i.handleSwitchChange.bind({basemap:i.basemaps,view:i.view})),null===(r=document.querySelector("#blend"))||void 0===r||r.removeAttribute("switched")},i}return J(t,e),t.prototype.render=function(){var e=this;return document.querySelectorAll("#basemapDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r;(null===(i=t.target)||void 0===i?void 0:i.checked)&&e.viewModel.toggleContent(null===(r=t.target)||void 0===r?void 0:r.value)}))})),l.tsx("div",{class:Ae},l.tsx("label",{class:"hidden",id:"blend"},l.tsx("calcite-switch",{afterCreate:this._blendCreated,id:"blendSwitch"})," Blend"),l.tsx("calcite-slider",{afterCreate:this._sliderCreated,class:"hidden",id:"blendSlider",value:"0.5",max:"1",min:"0",step:"0.1"}),l.tsx("div",{afterCreate:this._createMaps,id:"maps"}),l.tsx("div",{afterCreate:this._createImages,id:"images",class:"hidden"}),l.tsx("calcite-radio-group",{width:"full"},l.tsx("calcite-radio-group-item",{checked:!0,value:"maps",id:"mapsItem"},"Maps"),l.tsx("calcite-radio-group-item",{value:"images",id:"imagesItem",disabled:!0},"Imagery")))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.basemaps")],t.prototype,"basemaps",void 0),$([n.aliasOf("viewModel.images")],t.prototype,"images",void 0),$([n.property({type:Ee}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.BaseMaps")],t)}(s),Te=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){this.layerList=new N({view:e,container:"layerDiv",listItemCreatedFunction:function(t){var i=t.item;if("group"!=i.layer.type){var r=document.createElement("calcite-slider");r.setAttribute("min","0"),r.setAttribute("max","100"),r.setAttribute("min-label","0%"),r.setAttribute("max-label","100%"),r.setAttribute("label-handles",""),r.setAttribute("value",(100*(null==i?void 0:i.layer.opacity)).toString()),r.setAttribute("data",i.layer.id),r.addEventListener("calciteSliderUpdate",(function(t){var i;e.map.findLayerById(t.target.getAttribute("data")).opacity=parseInt(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.getAttribute("value"))/100})),i.panel={content:[r,"legend"],open:i.layer.visible},"Property"===i.layer.title&&(i.actionsSections=[[{title:"Show Labels",type:"toggle",id:"property-labels",value:i.layer.labelsVisible}]])}}}),this.layerList.on("trigger-action",(function(e){"property-labels"===e.action.id&&(e.item.layer.labelsVisible=e.action.value)}))},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.Layers.LayersViewModel")],t)}(c),De="esri-widget layers-base",Oe=function(e){function i(i){var r=e.call(this,i)||this;return r.viewModel=new Te,r.filterLayers=function(e){r.layerList.operationalItems.forEach((function(t){var i,r,a,o,n,l,s,c,d,u,p,v;if("group"===t.layer.type){var f=!1;t.layer.layers.forEach((function(t){t.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",f=!0):t.listMode="hide"})),e.length?f?(t.open=!0,null===(v=null===(p=null===(u=null===(d=document.querySelector("#layerDiv_"+t.uid+"__title"))||void 0===d?void 0:d.parentElement)||void 0===u?void 0:u.parentElement)||void 0===p?void 0:p.parentElement)||void 0===v||v.classList.remove("hidden")):(t.open=!1,null===(c=null===(s=null===(l=null===(n=document.querySelector("#layerDiv_"+t.uid+"__title"))||void 0===n?void 0:n.parentElement)||void 0===l?void 0:l.parentElement)||void 0===s?void 0:s.parentElement)||void 0===c||c.classList.add("hidden")):(t.open=!1,null===(o=null===(a=null===(r=null===(i=document.querySelector("#layerDiv_"+t.uid+"__title"))||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.parentElement)||void 0===a?void 0:a.parentElement)||void 0===o||o.classList.remove("hidden"))}}))},r._createLayers=function(){r.layerList&&(r.layerList.container="layerWidget")},r.clearClick=function(){var e;r.filterLayers(""),null===(e=document.querySelector("#layerSearch .calcite-input-clear-button"))||void 0===e||e.removeEventListener("click",r.clearClick)},r._createSearch=function(e){e.addEventListener("input",(function(t){var i;r.filterLayers(t.target.value),null===(i=e.querySelector(".calcite-input-clear-button"))||void 0===i||i.addEventListener("click",r.clearClick)}))},r._reset=function(){new t({portalItem:r.view.map.portalItem.clone()}).load().then((function(e){e.allLayers.forEach((function(e){r.view.map.findLayerById(e.id).visible=e.visible,"group"===e.type&&e.layers.forEach((function(e){r.view.map.findLayerById(e.id).visible=e.visible}))}))}))},r}return J(i,e),i.prototype.render=function(){return l.tsx("div",{class:De},l.tsx("div",{class:"flex sticky"},l.tsx("calcite-input",{clearable:!0,placeholder:"Filter by layer name",scale:"s",afterCreate:this._createSearch,id:"layerSearch"}),l.tsx("calcite-button",{"icon-start":"viewHide",scale:"s",color:"light",onclick:this._reset})),l.tsx("div",{afterCreate:this._createLayers,id:"layerWidget"}))},$([n.aliasOf("viewModel.view")],i.prototype,"view",void 0),$([n.aliasOf("viewModel.layerList")],i.prototype,"layerList",void 0),$([n.property({type:Te}),l.renderable()],i.prototype,"viewModel",void 0),i=$([n.subclass("app.widgets.Layers")],i)}(s),Le=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){this.search=new d({view:e,maxSuggestions:30,searchAllEnabled:!0}),this.search.allSources.on("after-add",(function(e){e.item.layer&&(e.item.name=e.item.layer.title,e.item.placeholder=e.item.layer.title)}))},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.LocationSearch.LocationSearchViewModel")],t)}(c),Ie="esri-widget locationsearch-base",Ce=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new Le,i._searchCreate=function(){i.search&&(i.search.container="locationSearch")},i}return J(t,e),t.prototype.render=function(){return l.tsx("div",{class:Ie},l.tsx("div",{afterCreate:this._searchCreate,id:"locationSearch"}))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.search")],t.prototype,"search",void 0),$([n.property({type:Le}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.LocationSearch")],t)}(s),Me=function(e){function t(t){var i=e.call(this,t)||this;return i.stopEvtPropagation=function(e){e.stopPropagation()},i.disableZooming=function(e){return e.popup.dockEnabled=!0,e.popup.actions=[],e.ui.components=["attribution"],e.on("mouse-wheel",i.stopEvtPropagation),e.on("double-click",i.stopEvtPropagation),e.on("double-click",["Control"],i.stopEvtPropagation),e.on("drag",i.stopEvtPropagation),e.on("drag",["Shift"],i.stopEvtPropagation),e.on("drag",["Shift","Control"],i.stopEvtPropagation),e.on("key-down",(function(e){var t=e.key;-1!==["+","-","Shift","_","="].indexOf(t)&&e.stopPropagation()})),e},y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){var t=this,r=new F({basemap:"streets-navigation-vector"});this.overviewMapView=new i({map:r,extent:e.extent}),this.disableZooming(this.overviewMapView),this.overviewMapView.ui.remove("zoom");var a=new h({geometry:null,symbol:{type:"simple-fill",color:[0,0,0,.5],outline:null}});this.overviewMapView.graphics.add(a),_.init(e,"extent",(function(){a.geometry=e.extent})),_.init(e,"stationary",(function(){e.stationary&&t.overviewMapView.goTo({center:e.center,scale:2*e.scale*Math.max(e.width/t.overviewMapView.width,e.height/t.overviewMapView.height)}).catch((function(e){"view:goto-interrupted"!=e.name&&console.error(e)}))}))},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.OverviewMap.OverviewMapViewModel")],t)}(c),Pe="esri-widget overviewmap-base",Re=function(e){function t(t){var i=e.call(this,t)||this;return i.name="",i.viewModel=new Me,i.overviewCreated=function(e){i.overviewMapView&&(i.overviewMapView.container=e)},i}return J(t,e),t.prototype.render=function(){return l.tsx("div",{class:Pe},l.tsx("div",{afterCreate:this.overviewCreated,id:"overviewDiv"}))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.overviewMapView")],t.prototype,"overviewMapView",void 0),$([n.aliasOf("viewModel.name"),l.renderable()],t.prototype,"name",void 0),$([n.property({type:Me}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.OverviewMap")],t)}(s),ke=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return J(t,e),t.prototype.init=function(e){console.log(e.scale)},$([n.property()],t.prototype,"view",void 0),t=$([n.subclass("app.widgets.Clear.ClearViewModel")],t)}(c),qe="esri-widget--button esri-widget",Ne="esri-icon esri-icon-trash",Fe=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new ke,i.clearTitle="Clear",i.renderIcon=function(){return l.tsx("span",{"aria-hidden":"true",class:i.classes(Ne)})},i._clear=function(){i.view.map.allLayers.filter((function(e){return"graphics"===e.type})).forEach((function(e){e.removeAll()}))},i}return J(t,e),t.prototype.render=function(){return l.tsx("div",{bind:this,class:this.classes(qe),role:"button",onclick:this._clear,onkeydown:this._clear,"aria-label":this.clearTitle,title:this.clearTitle},this.renderIcon())},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.property({type:ke}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.Clear")],t)}(s),_e=new Se;function Be(e,t){"Search"!==e||fe||(fe=new Y({view:t,condosTable:ae,addressTable:oe,propertyLayer:re,container:"sideDiv"}),he(t)),"Layers"!==e||le||(le=new Oe({view:t,container:"layerDiv"})),"Legend"!==e||se||(se=new r({view:t,container:"legendDiv"})),"Print"!==e||ve||(ve=new a({view:t,container:"printDiv",printServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"})),"Bookmarks"!==e||de||(de=new o({view:t,container:"bookmarkDiv",editingEnabled:!0})),"Basemaps"!==e||ce||(ce=new xe({view:t,container:"basemapDiv"})),"Location"!==e||ue||(ue=new Ce({view:t,container:"locationDiv"})),"Measure"!==e||ne||((ne=new X({view:t,container:"measureDiv"})).postInitialize=function(){pe&&(pe.measurement=ne.viewModel.measurement),_e&&(_e.measurement=ne.viewModel.measurement)}),"Draw"!==e||pe||(pe=new we({view:t,container:"drawDiv"}),ne&&(pe.measurement=ne.viewModel.measurement))}function je(e){var t=new b({view:e}),i=new S({content:t,mode:"floating",expandIconClass:"esri-icon-pan2"});e.ui.add(i,"bottom-left"),e.ui.add(new A({view:e}),"top-left");var r=new x({view:e});r.on("locate-error",(function(e){console.log(e)})),e.ui.add(r,"top-left");var a=new T({view:e});a.on("track-error",(function(e){console.log(e)})),e.ui.add(a,"top-left"),e.ui.add(new D({view:e}),"top-left"),e.ui.add(new Fe({view:e}),"top-left");var o=new Re({view:e}),n=new S({content:o,mode:"floating",expandIconClass:"esri-icon-overview-arrow-top-left"});return n.watch("expanded",(function(t){t&&o.viewModel.overviewMapView.goTo({center:e.center,scale:2*e.scale*Math.max(e.width/o.viewModel.overviewMapView.width,e.height/o.viewModel.overviewMapView.height)})})),e.ui.add(n,"bottom-right"),_e.container="selectDiv",_e.view=e,_e.layer=re,e}var We,Ue,Ge=function(e){function t(t){var i=e.call(this,t)||this;return i.ready=!1,i.reorderPanels=function(){i.view&&document.querySelectorAll(".panel.left").forEach((function(e){var t,i,r;window.innerWidth>=1e3?null===(t=e.parentElement)||void 0===t||t.insertBefore(e,document.querySelector("#viewDiv")):null===(i=e.parentElement)||void 0===i||i.insertBefore(e,null===(r=null===document||void 0===document?void 0:document.querySelector("#viewDiv"))||void 0===r?void 0:r.nextElementSibling)}))},i.initActions=function(){setTimeout((function(){var e,t,r=document.querySelectorAll("calcite-action-bar calcite-action");r.length&&(i.actions=r,null===(e=i.actions)||void 0===e||e.forEach((function(e){null==e||e.addEventListener("click",(function(t){i.toggleAction(t.target),setTimeout((function(){Be(t.target.text,i.view)})),i.actions.forEach((function(i){i.text!=t.target.text&&(window.innerWidth>=1e3?i.getAttribute("side")===e.getAttribute("side")&&i.removeAttribute("active"):i.removeAttribute("active"))})),e.setAttribute("active","")}))}))),window.innerWidth>=500&&(null===(t=document.querySelector('calcite-action[text="Search"'))||void 0===t||t.setAttribute("active",""))}))},i.toggleAction=function(e){window.innerWidth>=1e3?document.querySelectorAll(".panel."+e.getAttribute("side")).forEach((function(t){t.title!=e.text?t.classList.add("hidden"):(t.removeAttribute("dismissed"),t.hasAttribute("dismissed")||(window.innerWidth<500?t.setAttribute("style","min-width: calc(100% - 48px)"):t.setAttribute("style","min-width: 0px"),t.classList.remove("hidden"),t.title))})):document.querySelectorAll(".panel").forEach((function(t){t.title!=e.text?t.classList.add("hidden"):(t.removeAttribute("dismissed"),t.hasAttribute("dismissed")||(window.innerWidth<500?t.setAttribute("style","min-width: calc(100% - 48px)"):t.setAttribute("style","min-width: 0px"),t.classList.remove("hidden"),t.title))}))},i.enableActionbar=function(){i.reorderPanels(),setTimeout((function(){document.querySelectorAll("calcite-action-bar calcite-action").forEach((function(e){e.removeAttribute("disabled")}))}),1e3),i.ready=!0},y.whenDefinedOnce(i,"view",i.init.bind(i)),y.whenDefinedOnce(i,"side",i.sideSet.bind(i)),i}return J(t,e),t.prototype.sideSet=function(e){var t,i;"right"===e&&(null===(t=document.querySelector("#toolGroup"))||void 0===t||t.classList.add("hidden")),"left"===e&&(null===(i=document.querySelector("#searchGroup"))||void 0===i||i.classList.add("hidden"));var r=document.querySelectorAll("calcite-action-bar calcite-action");r.length&&(this.actions=r)},t.prototype.init=function(e){var t=this;console.log(e.scale),Be("Search",this.view),window.addEventListener("resize",(function(){setTimeout((function(){var e,i,r,a,o,n,l,s;window.innerWidth>=1e3?(null===(e=document.querySelector("#leftActionbar"))||void 0===e||e.classList.remove("hidden"),null===(r=null===(i=document.querySelector("#leftActionbar"))||void 0===i?void 0:i.querySelector("#toolGroup"))||void 0===r||r.classList.remove("hidden"),null===(o=null===(a=document.querySelector("#actionBar"))||void 0===a?void 0:a.querySelector("#toolGroup"))||void 0===o||o.classList.add("hidden")):(null===(n=document.querySelector("#leftActionbar"))||void 0===n||n.classList.add("hidden"),null===(s=null===(l=document.querySelector("#actionBar"))||void 0===l?void 0:l.querySelector("#toolGroup"))||void 0===s||s.classList.remove("hidden"),document.querySelectorAll(".panel.left").forEach((function(e){e.setAttribute("dismissed",""),e.classList.add("hidden")}))),t.reorderPanels()}),1e3)}))},$([n.property()],t.prototype,"view",void 0),$([n.property()],t.prototype,"side",void 0),$([n.property()],t.prototype,"ready",void 0),$([n.property()],t.prototype,"actions",void 0),t=$([n.subclass("app.widgets.ActionBar.ActionBarViewModel")],t)}(c),Ve="esri-widget actionbar-base",Je=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new Ge,i.searchGroupCreated=function(e){"left"===i.side&&e.classList.add("hidden"),i.actions||i.initActions()},i.toolGroupCreated=function(e){var t;"right"===i.side&&(window.innerWidth>=1e3?e.classList.add("hidden"):null===(t=document.querySelector("#leftActionbar"))||void 0===t||t.classList.add("hidden")),i.actions||i.initActions()},i}return J(t,e),t.prototype.render=function(){return l.tsx("div",{class:Ve},l.tsx("calcite-action-bar",{expand:"false"},l.tsx("calcite-action-group",{id:"searchGroup",afterCreate:this.searchGroupCreated},l.tsx("calcite-action",{text:"Search",icon:"search",side:"right",disabled:!0}),l.tsx("calcite-action",{text:"Location",icon:"pin",side:"right",disabled:!0}),l.tsx("calcite-action",{text:"Layers",icon:"layers",side:"right",disabled:!0}),l.tsx("calcite-action",{text:"Legend",icon:"legend",side:"right",disabled:!0}),l.tsx("calcite-action",{text:"Basemaps",icon:"basemap",side:"right",disabled:!0})),l.tsx("calcite-action-group",{id:"toolGroup",afterCreate:this.toolGroupCreated},l.tsx("calcite-action",{text:"Select",icon:"selection",side:"left",disabled:!0}),l.tsx("calcite-action",{text:"Measure",icon:"measure",side:"left",disabled:!0}),l.tsx("calcite-action",{text:"Draw",icon:"pencil-mark",side:"left",disabled:!0}),l.tsx("calcite-action",{text:"Bookmarks",icon:"bookmark",side:"left",disabled:!0}),l.tsx("calcite-action",{text:"Print",icon:"print",side:"left",disabled:!0}))))},$([n.aliasOf("viewModel.view")],t.prototype,"view",void 0),$([n.aliasOf("viewModel.side")],t.prototype,"side",void 0),$([n.property(),n.aliasOf("viewModel.ready")],t.prototype,"ready",void 0),$([n.aliasOf("viewModel.actions")],t.prototype,"actions",void 0),$([n.aliasOf("viewModel.toggleAction")],t.prototype,"toggleAction",void 0),$([n.aliasOf("viewModel.enableActionbar")],t.prototype,"enableActionbar",void 0),$([n.aliasOf("viewModel.initActions")],t.prototype,"initActions",void 0),$([n.property({type:Ge}),l.renderable()],t.prototype,"viewModel",void 0),t=$([n.subclass("app.widgets.ActionBar")],t)}(s),$e=new Je({side:"right",container:"actionBar"}),He=new Je({side:"left",container:"leftActionbar"});window.addEventListener("pagehide",(function(){e.view.map.removeMany(e.view.map.allLayers.filter((function(e){return"group"===e.type&&!e.layers.length})).toArray());var t=e.view.map.toJSON();t.initialState.viewpoint.targetGeometry=e.view.extent,window.localStorage.setItem("imaps",JSON.stringify(t))})),window.innerWidth>=500&&(null===(We=document.querySelector("calcite-panel.right"))||void 0===We||We.classList.remove("hidden"),null===(Ue=document.querySelector("calcite-panel.right"))||void 0===Ue||Ue.removeAttribute("dismissed")),document.querySelectorAll("calcite-panel").forEach((function(e){var t,i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector(".content-container");i&&(i.innerHTML+="<style>.content-container { height: 100%; } .container:focus, .content-container:focus { outline: none; }</style>"),new MutationObserver((function(e){for(var t=function(e){"attributes"===e.type&&"dismissed"===e.attributeName&&(document.querySelectorAll("calcite-action-bar calcite-action").forEach((function(t){t.text===e.target.title&&(e.target.hasAttribute("dismissed")?(e.target.classList.remove("maximized"),e.target.querySelector(".maximize").setAttribute("icon","left-edge"),t.removeAttribute("active")):t.setAttribute("active",""))})),window.innerWidth<=500&&setTimeout((function(){var t,i;e.target.hasAttribute("dismissed")?null===(t=document.querySelector("#viewDiv"))||void 0===t||t.classList.remove("below"):null===(i=document.querySelector("#viewDiv"))||void 0===i||i.classList.add("below")})))},i=0,r=e;i<r.length;i++)t(r[i])})).observe(e,{attributes:!0,childList:!1,subtree:!1})})),_.whenDefinedOnce($e,"actions",(function(r){r.length&&!e.view&&(e.view=new i({container:"viewDiv",map:B}),e.view.when((function(){$e.view=e.view,He.view=e.view,$e.enableActionbar(),function(e){if(window.localStorage.getItem("imaps")){var i=t.fromJSON(JSON.parse(window.localStorage.getItem("imaps")));i.load().then((function(){e.map.allLayers.forEach((function(e){var t=i.allLayers.find((function(t){return e.id===t.id}));e.visible=null==t?void 0:t.visible,e.opacity=null==t?void 0:t.opacity})),e.map.basemap=i.basemap,e.extent=i.initialViewProperties.viewpoint.targetGeometry.extent}))}}(e.view),e.view.map.watch("layers",(function(){e.view.map.allLayers.forEach((function(e){"group"!=e.type?e.watch("visible",(function(t){var i;null===(i=null==le?void 0:le.layerList)||void 0===i||i.operationalItems.forEach((function(i){if("group"===i.layer.type){var r=i.children.find((function(t){return t.layer===e}));r&&(r.panel.open=t)}}))})):e.watch("visible",(function(t){var i=null==le?void 0:le.layerList.operationalItems.find((function(t){return t.layer===e}));i&&(i.open=t)}))}))}));var i=B.allLayers.find((function(e){return"Property"===e.title&&"feature"===e.type}));e.view.on("hold",(function(e){fe.geometry=e.mapPoint,setTimeout((function(){}),1e3)})),e.view.whenLayerView(i).then((function(){var e;null===(e=document.querySelector("#mapLoader"))||void 0===e||e.toggleAttribute("active"),fe.propertyLayer=i,_e.viewModel.watch("geometry",(function(e){fe.geometry=e,$e.actions.forEach((function(e){"Search"===e.text&&$e.toggleAction(e)}))}))})).catch((function(e){console.log(e),function(e,t){var i;null===(i=document.querySelector("calcite-alert"))||void 0===i||i.remove();var r=document.createElement("calcite-alert"),a=document.createElement("div");a.setAttribute("slot","alert-message"),a.innerHTML=e,r.setAttribute("color",t),r.setAttribute("active",""),r.setAttribute("icon",""),r.appendChild(a),document.body.appendChild(r)}("Property layer did not load. Please contact iMAPS Help Desk.","red")}))})),e.view.when(je),e.view.when(G))})),document.querySelectorAll("calcite-panel div").forEach((function(e){"header-actions-end"===e.slot&&e.setAttribute("style","display: flex; flex-direction: row;")})),window.onresize=function(e){var t;(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.innerWidth)>=500?document.querySelectorAll("calcite-panel").forEach((function(e){var t;e.hasAttribute("dismissed")||("minimize"===(null===(t=e.querySelector(".maximize"))||void 0===t?void 0:t.getAttribute("icon"))?e.setAttribute("style","min-width: calc(100% - 48px)"):e.setAttribute("style","min-width: 0px"))})):document.querySelectorAll("calcite-panel").forEach((function(e){e.getAttribute("dismissed")?e.setAttribute("style","width: 0px"):e.setAttribute("style","min-width: calc(100% - 48px)")}))},document.querySelectorAll("calcite-panel").forEach((function(e){e.addEventListener("calcitePanelDismissedChange",(function(){document.querySelectorAll("calcite-panel").forEach((function(){e.setAttribute("style","width: 0px")}))}))})),document.querySelectorAll(".maximize").forEach((function(e){e.addEventListener("click",(function(){var t,i,r,a,o,n,l,s,c,d,u,p,v;null===(i=null===(t=e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===i||i.removeAttribute("dismissed"),null===(a=null===(r=e.parentElement)||void 0===r?void 0:r.parentElement)||void 0===a||a.classList.remove("hidden"),"left-edge"===e.getAttribute("icon")?(e.setAttribute("icon","right-edge"),null===(n=null===(o=e.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n||n.classList.add("maximized"),null===(s=null===(l=e.parentElement)||void 0===l?void 0:l.parentElement)||void 0===s||s.setAttribute("style","min-width: calc(100% - 96px)"),document.querySelectorAll("calcite-panel.left:not(.hidden)").forEach((function(e){e.classList.add("hidden"),e.setAttribute("dismissed","")})),null===(c=document.querySelector('calcite-action[side="left"][active]'))||void 0===c||c.removeAttribute("active")):"right-edge"===e.getAttribute("icon")&&(e.setAttribute("icon","left-edge"),null===(u=null===(d=e.parentElement)||void 0===d?void 0:d.parentElement)||void 0===u||u.classList.remove("maximized"),null===(v=null===(p=e.parentElement)||void 0===p?void 0:p.parentElement)||void 0===v||v.setAttribute("style","min-width:350px"))}))})),function(){var e;if(null===(e=document.querySelector("calcite-dropdown"))||void 0===e||e.addEventListener("calciteDropdownSelect",(function(e){var t,i=null===(t=e.currentTarget.selectedItems[0])||void 0===t?void 0:t.getAttribute("value");W(j=i),window.localStorage.setItem("theme",j)})),window.localStorage.getItem("theme")){var t=window.localStorage.getItem("theme");W(t),document.querySelectorAll("calcite-dropdown-item").forEach((function(e){if(e.hasAttribute("active")){e.getAttribute("value")!=t&&e.removeAttribute("active");var i=e.getAttribute("value");j=i}else e.getAttribute("value")===t&&e.setAttribute("active","")}))}else window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&W("dark")}(),Object.defineProperty(e,"__esModule",{value:!0})}));
