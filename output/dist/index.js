define(["exports","esri/WebMap","esri/widgets/Legend","esri/widgets/Print","esri/widgets/Bookmarks","esri/core/accessorSupport/decorators","esri/widgets/support/widget","esri/widgets/Widget","esri/core/Accessor","esri/widgets/Search","esri/widgets/FeatureTable","esri/layers/FeatureLayer","esri/layers/GraphicsLayer","esri/widgets/Feature","esri/widgets/Search/LayerSearchSource","esri/widgets/FeatureTable/FieldColumnConfig","esri/PopupTemplate","esri/core/watchUtils","esri/widgets/CoordinateConversion","esri/widgets/Expand","esri/widgets/Measurement","esri/widgets/Compass","esri/widgets/Locate","esri/widgets/Track","esri/Color","esri/widgets/Sketch","esri/Graphic","esri/symbols/TextSymbol","esri/widgets/BasemapGallery","esri/widgets/LayerList","esri/views/MapView","esri/geometry/geometryEngine"],(function(e,t,i,r,a,o,n,l,s,c,d,u,p,v,f,m,h,y,w,b,g,S,E,D,O,x,L,T,A,I,M,C){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,S=S&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S,E=E&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E,D=D&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D,O=O&&Object.prototype.hasOwnProperty.call(O,"default")?O.default:O,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,L=L&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L,T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,A=A&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A,I=I&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I,M=M&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M,C=C&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C;var F=new t;F=new t({portalItem:{id:"95092428774c4b1fb6a3b6f5fed9fbc4"}}),window.localStorage.getItem("imaps")&&(F=t.fromJSON(JSON.parse(window.localStorage.getItem("imaps"))));var N="light",k=function(e){document.querySelectorAll("calcite-panel").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-color").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-tip-manager").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("calcite-dropdown").forEach((function(t){t.setAttribute("theme",e)})),document.querySelectorAll("link").forEach((function(t){t.href.includes("light"===e?"dark":"light")&&(t.href="https://js.arcgis.com/4.16/esri/themes/"+e+"/main.css")}))},P=[{panel:{name:"selectTip",title:"Selection",tips:[{message:"To draw a continuous line or polygon, long press and drag your cursor",title:"Freehand Drawing"},{message:"To draw a continuous line or polygon, long press and drag your cursor",title:"Freehand Drawing"}]}},{panel:{name:"propertySearchTip",title:"Property Search",tips:[{message:"To search by a portion of an owner name or address, hit enter without selecting form the list of suggestions.",title:"Wildcard Search"},{message:"To quickly select a property from the map, long press on a property on the map.",title:"Long Press"},{message:"To select by a location use the property selection tool.",title:"Select By Location"}]}},{panel:{name:"basemapTip",title:"Basemaps",tips:[{message:"The imagery and imagery hybrid base maps listed under the maps tab is a combination of the latest imagery from Raleigh (2019) and from the State of North Carolina (2017).",title:"Imagery Basemaps"}]}}];
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var R=function(e,t){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function _(e,t){function i(){this.constructor=e}R(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function q(e,t,i,r){var a,o=arguments.length,n=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(o<3?a(n):o>3?a(t,i,n):a(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}var B=function(e){function t(t){var i=e.call(this,t)||this;return i.graphics=new p({id:"property-select",listMode:"hide",minScale:19200}),i.singleSymbol={type:"simple-fill",style:"none",outline:{width:2.5,color:[255,82,82,1]},color:[253,46,65,.25]},i.multiSymbol={type:"simple-fill",style:"none",outline:{width:2.5,color:[249,243,0,1]},color:[253,46,65,.25]},i.arcadeExpressionInfos=[{name:"bom-doc-num",title:"bom-doc-num",expression:"var results = FeatureSetByRelationshipName($feature, 'CONDO_BOOKS', ['*'], false); return First(results).BOM_DOC_NUM;"},{name:"deed-doc-num",title:"deed-doc-num",expression:"var results = FeatureSetByRelationshipName($feature, 'CONDO_BOOKS', ['*'], false); return First(results).DEED_DOC_NUM;"},{name:"mailing-address",title:"mailing-address",expression:"When(IsEmpty($feature.ADDR3),$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2,$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2 + TextFormatting.NewLine + $feature.ADDR3)"},{name:"property-values",title:"property-values",expression:'"Building Value"+TextFormatting.NewLine+"$"+$feature.BLDG_VAL+TextFormatting.NewLine+"Land Value"+TextFormatting.NewLine+"$"+$feature.LAND_VAL+TextFormatting.NewLine+"Total Value"+TextFormatting.NewLine+"$"+$feature.TOTAL_VALUE_ASSD'},{name:"deed-book-page",title:"deed-book-page",expression:'"Book "+$feature.DEED_BOOK+" Page "+$feature.DEED_PAGE'},{name:"general",title:"general",expression:'"PIN"+TextFormatting.NewLine+$feature.PIN_NUM+" "+$feature.PIN_EXT+TextFormatting.NewLine+"REID"+TextFormatting.NewLine+$feature.REID+TextFormatting.NewLine+"City"+TextFormatting.NewLine+Proper($feature.CITY_DECODE)+TextFormatting.NewLine+"Jurisdiction"+TextFormatting.NewLine+$feature.PLANNING_JURISDICTION+TextFormatting.NewLine+"Township"+TextFormatting.NewLine+Proper($feature.TOWNSHIP_DECODE)'}],i.popupTemplate=new h({expressionInfos:i.arcadeExpressionInfos,content:[{type:"text",text:'<h1 class="text-green">{SITE_ADDRESS}</h1><h2>General</h2>{expression/general}<h2>Owner</h2>{OWNER}<br/>{expression/mailing-address}<h2>Valuation</h2>{expression/property-values}<h2>Sale Information</h2>{TOTSALPRICE}<br/>{SALE_DATE}<h2>Deeds</h2>{expression/deed-book-page}<br/><strong>Deed Date</strong><br/>{DEED_DATE}<br/><br/>Legal Description<br/>{PROPDESC}<br/><a href="http://services.wakegov.com/booksweb/pdfview.aspx?docid={expression/bom-doc-num}&RecordDate=" target="_blank">Book of Maps</a><br/><a href="http://services.wakegov.com/booksweb/pdfview.aspx?docid={expression/deed-doc-num}&RecordDate=" target="_blank">Deed</a>'},{type:"media",mediaInfos:[]}]}),i.createFeatureTableLayer=function(e,t){return new u({fields:e,source:t,title:"Selected properties",geometryType:"point",objectIdField:"OBJECTID",spatialReference:i.view.spatialReference})},i.addGraphics=function(e){i.graphics.removeAll(),e.features.forEach((function(t){t.symbol=e.features.length>1?i.multiSymbol:i.singleSymbol,i.graphics.add(t)}))},i.getProperty=function(e,t){var r=i.condosTable.relationships.find((function(e){return"CONDO_PROPERTY"===e.name}));i.condosTable.queryRelatedFeatures({relationshipId:null==r?void 0:r.id,objectIds:e,outFields:["OBJECTID","REID"],returnGeometry:!1}).then((function(e){var r=[];for(var a in e)e[a].features.forEach((function(e){r.push(e.getAttribute("OBJECTID"))}));i.propertyLayer.queryFeatures({objectIds:r,outFields:["*"],returnGeometry:!0,outSpatialReference:{wkid:102100}}).then((function(e){if(i.view.goTo(e.features),!t){i.addGraphics(e);var r=[];e.features.forEach((function(e){var t=e.clone();t.geometry=t.geometry.centroid,r.push(t)})),i.clusterPoints.queryFeatures({where:"1=1",returnGeometry:!1,outFields:["OBJECTID"]}).then((function(e){i.clusterPoints.applyEdits({deleteFeatures:e.features}).then((function(){i.clusterPoints.applyEdits({addFeatures:r}).then((function(){i.clusterPoints.refresh()}))}))}))}}))}))},i.searchComplete=function(e){var t,r,a;if(i.searchWidget.viewModel.selectedSuggestion){if(e.numResults){var o=e.results[0].source.layer,n=[];if(e.results[0].results.forEach((function(e){n.push(e.feature.getObjectId())})),4===o.layerId){var l=o.relationships.find((function(e){return"ADDRESSES_CONDO"===e.name}));l&&n&&o.queryRelatedFeatures({relationshipId:l.id,objectIds:n,outFields:["*"]}).then((function(e){var t=[];for(var r in e)e[r].features.forEach((function(e){t.push(e.getAttribute("OBJECTID")),i.getProperty(t),e.layer=i.condosTable,i.setFeature(e,i.view,[],t),i.toggleContent("feature"),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,[e])}))}))}else i.condosTable.queryFeatures({objectIds:n,outFields:["*"]}).then((function(e){var t=[];e.features.forEach((function(e){t.push(e.getAttribute("OBJECTID"))})),i.getProperty(t),i.setFeature(e.features[0],i.view,[],t),i.toggleContent("feature"),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,e.features)}))}}else{var s=[],c="";i.searchWidget.activeSource?((null===(t=i.searchWidget.activeSource)||void 0===t?void 0:t.searchFields.includes("OWNER"))&&(c="OWNER like '%"+e.searchTerm.toUpperCase()+"%'"),(null===(r=i.searchWidget.activeSource)||void 0===r?void 0:r.searchFields.includes("PIN_NUM"))&&(c="PIN_NUM like '%"+e.searchTerm.toUpperCase()+"%'"),(null===(a=i.searchWidget.activeSource)||void 0===a?void 0:a.searchFields.includes("REID"))&&(c="REID like '%"+e.searchTerm.toUpperCase()+"%'")):c="OWNER like '"+e.searchTerm.toUpperCase()+"%' OR REID like '"+e.searchTerm.toUpperCase()+"%' OR PIN_NUM like '"+e.searchTerm.toUpperCase()+"%'";var d=[];i.condosTable.queryFeatures({where:c,outFields:["*"]}).then((function(t){var r;d=t.features,t.features.forEach((function(e){s.push(e.getObjectId())})),c=!i.searchWidget.activeSource||(null===(r=i.searchWidget.activeSource)||void 0===r?void 0:r.searchFields.includes("ADDRESS"))?"ADDRESS like '%"+e.searchTerm.toUpperCase()+"%'":"ADDRESS IS NULL",i.addressTable.queryFeatures({where:c,outFields:["*"]}).then((function(e){var t=i.addressTable.relationships.find((function(e){return"ADDRESSES_CONDO"===e.name})),r=[];e.features.forEach((function(e){r.push(e.getObjectId())})),t&&r.length?i.addressTable.queryRelatedFeatures({relationshipId:t.id,objectIds:r,outFields:["*"]}).then((function(e){for(var t in e)e[t].features.forEach((function(e){s.push(e.getAttribute("OBJECTID")),d.push(e)}));i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,d),i.getProperty(s),i.featureTable.renderNow()})):(i.getProperty(s),i.featureTable.layer=i.createFeatureTableLayer(i.condosTable.fields,d),i.featureTable.renderNow())}))}))}},i.toggleContent=function(e){var t,i,r,a,o,n,l,s;"table"===e?(null===(t=document.querySelector("#table"))||void 0===t||t.classList.remove("hidden"),null===(i=document.querySelector("#feature"))||void 0===i||i.classList.add("hidden"),null===(r=document.querySelector("#tableItem"))||void 0===r||r.setAttribute("checked",""),null===(a=document.querySelector("#featureItem"))||void 0===a||a.removeAttribute("checked")):(null===(o=document.querySelector("#feature"))||void 0===o||o.classList.remove("hidden"),null===(n=document.querySelector("#table"))||void 0===n||n.classList.add("hidden"),null===(l=document.querySelector("#featureItem"))||void 0===l||l.setAttribute("checked",""),null===(s=document.querySelector("#tableItem"))||void 0===s||s.removeAttribute("checked"))},y.whenDefinedOnce(i,"view",i.init.bind(i)),y.whenDefinedOnce(i,"condosTable",i.initSearch.bind(i)),y.whenDefined(i,"geometry",i.searchByGeometry.bind(i)),i}return _(t,e),t.prototype.searchByGeometry=function(e){var t=this;this.propertyLayer.queryFeatures({geometry:e,returnGeometry:!0,outFields:["OBJECTID","REID"]}).then((function(i){var r=t.propertyLayer.relationships.find((function(e){return"PROPERTY_CONDO"===e.name})),a=[];i.features.forEach((function(e){a.push(e.getObjectId())})),t.propertyLayer.queryRelatedFeatures({relationshipId:null==r?void 0:r.id,objectIds:a,outFields:["*"]}).then((function(r){var a=[];for(var o in r)a=a.concat(r[o].features);t.featureTable.layer=t.createFeatureTableLayer(t.condosTable.fields,a),1===a.length?(a[0].geometry||(a[0].geometry=e),t.setFeature(a[0],t.view,[],[a[0].getObjectId()]),t.toggleContent("feature")):t.toggleContent("table"),t.featureTable.renderNow(),t.graphics.removeAll(),i.features.forEach((function(e){e.symbol=i.features.length>1?t.multiSymbol:t.singleSymbol,t.graphics.add(e)}))}))}))},t.prototype.setFeature=function(e,t,i,r){var a=this,o=this.condosTable.relationships.find((function(e){return"CONDO_PHOTOS"===e.name}));i=[],this.condosTable.queryRelatedFeatures({relationshipId:null==o?void 0:o.id,objectIds:r,outFields:["*"]}).then((function(t){for(var r in t)t[r].features.forEach((function(e){i.push({title:"",type:"image",caption:"",value:{sourceURL:"http://services.wakegov.com/realestate/photos/mvideo/"+e.getAttribute("IMAGEDIR")+"/"+e.getAttribute("IMAGENAME")}})}));a.condosTable.popupTemplate.content[1].mediaInfos=i,e.layer=a.condosTable,e.popupTemplate=e.layer.popupTemplate,a.feature.graphic=e,a.feature.graphic.symbol=a.singleSymbol;var o=a.graphics.graphics.find((function(e){return"true"===e.getAttribute("selected")}));o&&(o.symbol=a.multiSymbol,o.setAttribute("selected","false"));var n=a.graphics.graphics.find((function(t){return t.getAttribute("REID")===e.getAttribute("REID")}));n&&(n.symbol=a.singleSymbol,n.setAttribute("selected","true"),a.graphics.graphics.reorder(n,a.graphics.graphics.length-1))}))},t.prototype.exportTable=function(){this.featureTable.layer.queryFeatures({outFields:["*"]}).then((function(e){var t="";e.fields.forEach((function(e){t+=e.alias+","})),t+="\r\n",e.features.forEach((function(e){for(var i in e.attributes)i.toLowerCase().includes("date")?t+='"'+new Date(e.attributes[i]).toDateString()+'",':i.toLowerCase().includes("acres")?t+='"'+parseFloat(e.attributes[i]).toFixed(2)+'",':t+='"'+e.attributes[i]+'",';t+="\r\n"}));var i=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){var a=URL.createObjectURL(i);r.setAttribute("href",a),r.setAttribute("download","imaps_export.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}))},t.prototype.init=function(e){e.map.add(this.graphics,e.map.allLayers.length-1),this.clusterPoints=new u({source:[],objectIdField:"OBJECTID",geometryType:"point",maxScale:19201,listMode:"hide",renderer:{type:"simple",symbol:{type:"simple-marker",size:4,color:"#69dcff",outline:{color:"rgba(0, 139, 174, 0.5)",width:5}}},featureReduction:{type:"cluster",labelingInfo:[{deconflictionStrategy:"none",labelExpressionInfo:{expression:"Text($feature.cluster_count, '#,###')"},symbol:{type:"text",color:"#004a5d",font:{weight:"bold",family:"Noto Sans",size:"12px"}},labelPlacement:"center-center"}]},spatialReference:this.view.spatialReference}),this.view.map.add(this.clusterPoints)},t.prototype.initSearch=function(e){var t,i,r,a=this,o=new u({fields:[{name:"SITE_ADDRESS",type:"string",alias:"Address"},{name:"OWNER",type:"string",alias:"Owner"},{name:"PIN_NUM",type:"string",alias:"PIN"},{name:"REID",type:"string",alias:"REID"}],source:[],title:"Selected properties",geometryType:"point",objectIdField:"OBJECTID",spatialReference:this.view.spatialReference});this.feature=new v({view:this.view}),this.featureTable=new d({view:this.view,layer:o,fieldConfigs:[new m({name:"SITE_ADDRESS",label:"Address",editable:!1,required:!0}),new m({name:"OWNER",label:"Owner",editable:!1,required:!0}),new m({name:"PIN_NUM",label:"PIN",editable:!1,required:!0}),new m({name:"REID",label:"REID",editable:!1,required:!0})],menuConfig:{items:[{label:"Export"}]}});var n=null===(r=null===(i=null===(t=this.featureTable)||void 0===t?void 0:t.menuConfig)||void 0===i?void 0:i.items)||void 0===r?void 0:r.find((function(e){return"Export"===e.label}));n.clickFunction=function(){a.exportTable()},n.clickFunction.bind(this.featureTable),this.featureTable.on("selection-change",(function(e){a.featureTable.clearSelection(),e.added.length&&(a.getProperty([e.added[0].feature.getAttribute("OBJECTID")],"table"),a.setFeature(e.added[0].feature,a.view,[],[e.added[0].feature.getAttribute("OBJECTID")]),e.added[0].feature.setAttribute("selected","true"),a.toggleContent("feature"))})),this.searchWidget=new c({allPlaceholder:"Address, owner, PIN, or REID",includeDefaultSources:!1,container:"search",sources:[new f({layer:this.addressTable,searchFields:["ADDRESS"],displayField:"ADDRESS",exactMatch:!1,outFields:["ADDRESS","REA_REID"],name:"Site Address",placeholder:"example: 222 W HARGETT"}),new f({layer:e,searchFields:["OWNER"],displayField:"OWNER",exactMatch:!1,outFields:["OWNER","REID","OBJECTID"],name:"Owner",placeholder:"example: SMITH, JOHN"}),new f({layer:e,searchFields:["PIN_NUM"],displayField:"PIN_NUM",exactMatch:!1,outFields:["PIN_NUM","REID","OBJECTID"],name:"PIN",placeholder:"example: 0712345678"}),new f({layer:e,searchFields:["REID"],displayField:"REID",exactMatch:!1,outFields:["REID","OBJECTID"],name:"REID",placeholder:"example: 0123456"})]}),this.searchWidget.viewModel.watch("results",(function(e){console.log(e)})),this.searchWidget.on("search-complete",this.searchComplete)},q([o.property()],t.prototype,"view",void 0),q([o.property()],t.prototype,"condosTable",void 0),q([o.property()],t.prototype,"addressTable",void 0),q([o.property()],t.prototype,"propertyLayer",void 0),q([o.property()],t.prototype,"searchWidget",void 0),q([o.property()],t.prototype,"featureTable",void 0),q([o.property()],t.prototype,"feature",void 0),q([o.property()],t.prototype,"geometry",void 0),t=q([o.subclass("app.widgets.PropertySearch.PropertySearchViewModel")],t)}(s),j="esri-widget propertysearch-base",W=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new B,i._createSearch=function(){i.searchWidget&&(i.searchWidget.container="search")},i._createTable=function(){i.featureTable&&(i.featureTable.container="table")},i._createFeature=function(){i.feature&&(i.feature.container="featureDiv")},i.currentRadioButton="list",i}return _(t,e),t.prototype.render=function(){var e=this;return document.querySelectorAll("#sideDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r,a;(null===(i=t.target)||void 0===i?void 0:i.checked)&&(console.log(null===(r=t.target)||void 0===r?void 0:r.value),e.viewModel.toggleContent(null===(a=t.target)||void 0===a?void 0:a.value))}))})),n.tsx("div",{class:j},n.tsx("div",{afterCreate:this._createSearch,id:"search"}),n.tsx("div",{afterCreate:this._createTable,id:"table"}),n.tsx("div",{id:"feature",class:"hidden"},n.tsx("div",{id:"featureDiv",afterCreate:this._createFeature})),n.tsx("calcite-radio-group",{width:"full"},n.tsx("calcite-radio-group-item",{checked:!0,value:"table",id:"tableItem"},"List"),n.tsx("calcite-radio-group-item",{value:"feature",id:"featureItem",disabled:!0},"Details")))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.condosTable")],t.prototype,"condosTable",void 0),q([o.aliasOf("viewModel.addressTable")],t.prototype,"addressTable",void 0),q([o.aliasOf("viewModel.propertyLayer")],t.prototype,"propertyLayer",void 0),q([o.aliasOf("viewModel.searchWidget")],t.prototype,"searchWidget",void 0),q([o.aliasOf("viewModel.featureTable")],t.prototype,"featureTable",void 0),q([o.aliasOf("viewModel.feature")],t.prototype,"feature",void 0),q([o.aliasOf("viewModel.geometry")],t.prototype,"geometry",void 0),q([o.property({type:B}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.PropertySearch")],t)}(l),$=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.init=function(e){console.log(e.scale)},t.prototype.measureOpened=function(){var e=document.querySelector("#measureDiv calcite-radio-group").selectedItem.title;"clear"!=e?this.measurement.activeTool=e:this.measurement.clear()},t.prototype.initMeasure=function(){this.measurement=new g({view:this.view,container:"measureWidget"})},q([o.property()],t.prototype,"view",void 0),t=q([o.subclass("app.widgets.Measure.MeasureViewModel")],t)}(s),U="esri-widget measure-base",G=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new $,i._measureCreated=function(){i.initMeasure()},i}return _(t,e),t.prototype.render=function(){var e=this;return document.querySelectorAll("#measureDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r,a,o;(null===(i=t.target)||void 0===i?void 0:i.checked)&&(console.log(null===(r=t.target)||void 0===r?void 0:r.title),"clear"===(null===(a=t.target)||void 0===a?void 0:a.title)?e.measurement.clear():e.measurement.activeTool=null===(o=t.target)||void 0===o?void 0:o.title)}))})),n.tsx("div",{class:U},n.tsx("calcite-radio-group",{width:"full"},n.tsx("calcite-radio-group-item",{checked:!0,title:"distance",value:"distance",id:"tableItem",icon:"measure"},"Line"),n.tsx("calcite-radio-group-item",{title:"area",value:"area",id:"featureItem",icon:"measure-area"},"Area"),n.tsx("calcite-radio-group-item",{title:"clear",value:"clear",id:"featureItem",icon:"trash"},"Clear")),n.tsx("div",{afterCreate:this._measureCreated,id:"measureWidget"}))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.measurement")],t.prototype,"measurement",void 0),q([o.aliasOf("viewModel.initMeasure")],t.prototype,"initMeasure",void 0),q([o.aliasOf("viewModel.measureOpened")],t.prototype,"measureOpened",void 0),q([o.property({type:$}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.Measure")],t)}(l),J=new h({expressionInfos:[{name:"bom-doc-num",title:"bom-doc-num",expression:"var results = FeatureSetByRelationshipName($feature, 'CONDO_BOOKS', ['*'], false); return First(results).BOM_DOC_NUM;"},{name:"deed-doc-num",title:"deed-doc-num",expression:"var results = FeatureSetByRelationshipName($feature, 'CONDO_BOOKS', ['*'], false); return First(results).DEED_DOC_NUM;"},{name:"mailing-address",title:"mailing-address",expression:"When(IsEmpty($feature.ADDR3),$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2,$feature.ADDR1 + TextFormatting.NewLine + $feature.ADDR2 + TextFormatting.NewLine + $feature.ADDR3)"},{name:"property-values",title:"property-values",expression:'"Building Value"+TextFormatting.NewLine+"$"+$feature.BLDG_VAL+TextFormatting.NewLine+"Land Value"+TextFormatting.NewLine+"$"+$feature.LAND_VAL+TextFormatting.NewLine+"Total Value"+TextFormatting.NewLine+"$"+$feature.TOTAL_VALUE_ASSD'},{name:"deed-book-page",title:"deed-book-page",expression:'"Book "+$feature.DEED_BOOK+" Page "+$feature.DEED_PAGE'},{name:"general",title:"general",expression:'"PIN"+TextFormatting.NewLine+$feature.PIN_NUM+" "+$feature.PIN_EXT+TextFormatting.NewLine+"REID"+TextFormatting.NewLine+$feature.REID+TextFormatting.NewLine+"City"+TextFormatting.NewLine+Proper($feature.CITY_DECODE)+TextFormatting.NewLine+"Jurisdiction"+TextFormatting.NewLine+$feature.PLANNING_JURISDICTION+TextFormatting.NewLine+"Township"+TextFormatting.NewLine+Proper($feature.TOWNSHIP_DECODE)'}],content:[{type:"text",text:'<h1 class="text-green">{SITE_ADDRESS}</h1><h2>General</h2>{expression/general}<h2>Owner</h2>{OWNER}<br/>{expression/mailing-address}<h2>Valuation</h2>{expression/property-values}<h2>Sale Information</h2>{TOTSALPRICE}<br/>{SALE_DATE}<h2>Deeds</h2>{expression/deed-book-page}<br/><strong>Deed Date</strong><br/>{DEED_DATE}<br/><br/>Legal Description<br/>{PROPDESC}<br/><a href="http://services.wakegov.com/booksweb/pdfview.aspx?docid={expression/bom-doc-num}&RecordDate=" target="_blank">Book of Maps</a><br/><a href="http://services.wakegov.com/booksweb/pdfview.aspx?docid={expression/deed-doc-num}&RecordDate=" target="_blank">Deed</a>'},{type:"media",mediaInfos:[]}]}),V=new u({portalItem:{id:"08050bf067bb4b20adea4b0b4f0a39e3"},spatialReference:{wkid:102100}}),H=new u({portalItem:{id:"08050bf067bb4b20adea4b0b4f0a39e3"},layerId:1,spatialReference:{wkid:102100},popupTemplate:J});H.load();var z=new u({portalItem:{id:"08050bf067bb4b20adea4b0b4f0a39e3"},layerId:4,spatialReference:{wkid:102100}});z.load();var K,Y,X,Q,Z,ee,te,ie=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.initDraw=function(){var e=this;this.graphics=new p({listMode:"hide"}),this.view.map.add(this.graphics),this.sketch=new x({view:this.view,container:"sketchDiv",layer:this.graphics,creationMode:"single"}),this.sketch.viewModel.pointSymbol.color=O.fromHex("#FF0000"),this.sketch.viewModel.pointSymbol.outline.color=O.fromHex("#FF0000"),this.sketch.viewModel.polygonSymbol.color=new O([[255,0,0,.5]]),this.sketch.viewModel.polygonSymbol.outline.color=O.fromHex("#FF0000"),this.sketch.viewModel.polylineSymbol.color=O.fromHex("#FF0000"),this.sketch.watch("activeTool",(function(e){var t;null!=e&&(null===(t=null==ye?void 0:ye.measurement)||void 0===t||t.clear())})),this.sketch.on("create",(function(t){var i,r;if("start"===t.state&&(null===(i=null==ye?void 0:ye.measurement)||void 0===i||i.clear()),"complete"===t.state&&(null===(r=e.label)||void 0===r?void 0:r.length)){var a=t.graphic.geometry;"polygon"===t.graphic.geometry.type&&(a=t.graphic.geometry.centroid);var o=new L({geometry:a,symbol:new T({text:e.label,color:e.textColor,haloColor:"white",haloSize:1,xoffset:"5px",yoffset:"5px",verticalAlignment:"bottom",horizontalAlignment:"right"})});e.graphics.add(o)}}))},t.prototype.init=function(e){console.log(e.scale)},q([o.property()],t.prototype,"view",void 0),q([o.property()],t.prototype,"container",void 0),t=q([o.subclass("app.widgets.Draw.DrawViewModel")],t)}(s),re="esri-widget draw-base",ae=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new ie,i._drawUpdated=function(){i.viewModel.sketch||i.viewModel.initDraw()},i}return _(t,e),t.prototype.render=function(){var e=this,t=document.querySelector("#fill");null==t||t.setAttribute("value","#ff0000"),null==t||t.addEventListener("calciteColorChange",(function(t){var i=t.target.value;e.viewModel.sketch.viewModel.pointSymbol.color=O.fromHex(i),e.viewModel.sketch.viewModel.polygonSymbol.color=O.fromHex(i)}));var i=document.querySelector("#line");null==i||i.setAttribute("value","#ff0000"),null==i||i.addEventListener("calciteColorChange",(function(t){var i=t.target.value;e.viewModel.sketch.viewModel.polylineSymbol.color=O.fromHex(i),e.viewModel.sketch.viewModel.pointSymbol.outline.color=O.fromHex(i),e.viewModel.sketch.viewModel.polygonSymbol.outline.color=O.fromHex(i)}));var r=document.querySelector("#opacity");null==r||r.addEventListener("calciteSliderUpdate",(function(t){e.viewModel.sketch.viewModel.polygonSymbol.color.a=t.target.value}));var a=document.querySelector("#width");null==a||a.addEventListener("calciteSliderUpdate",(function(t){e.viewModel.sketch.viewModel.polylineSymbol.width=parseFloat(t.target.value),e.viewModel.sketch.viewModel.pointSymbol.outline.width=parseFloat(t.target.value),e.viewModel.sketch.viewModel.polygonSymbol.outline.width=parseFloat(t.target.value)}));var o=document.querySelector("#label");null==o||o.addEventListener("calciteInputBlur",(function(t){e.set("label",t.target.value)}));var l=document.querySelector("#textColor");return null==l||l.setAttribute("value","#ff0000"),null==l||l.addEventListener("calciteColorChange",(function(t){e.set("textColor",O.fromHex(t.target.value))})),n.tsx("div",{class:re},n.tsx("div",{afterUpdate:this._drawUpdated,id:"sketchDiv"}),n.tsx("calcite-block",{heading:"Settings",open:!0,collapsible:!0},n.tsx("calcite-block-section",{text:"Color"},n.tsx("calcite-label",{scale:"s"},"Fill Color ",n.tsx("calcite-color",{id:"fill",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"})),n.tsx("calcite-label",{scale:"s"},"Line Color ",n.tsx("calcite-color",{id:"line",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"}))),n.tsx("calcite-block-section",{text:"Fill Opacity"},n.tsx("calcite-label",{scale:"s"},"Opacity",n.tsx("calcite-slider",{scale:"s",id:"opacity",max:"1",min:"0",value:"0.5",step:"0.1"}))),n.tsx("calcite-block-section",{text:"Outline"},n.tsx("calcite-label",{scale:"s"},"Width ",n.tsx("calcite-slider",{id:"width",max:"10",min:"0",value:"1",step:"0.5"}))),n.tsx("calcite-block-section",{text:"Labeling"},n.tsx("calcite-label",{scale:"s"},"Label ",n.tsx("calcite-input",{scale:"s",id:"label",type:"textarea"})),n.tsx("calcite-label",{scale:"s"},"Text Color",n.tsx("calcite-color",{id:"textColor",hideChannels:!0,hideSaved:!0,appearance:"minimal",scale:"s"})))))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.label")],t.prototype,"label",void 0),q([o.aliasOf("viewModel.textColor")],t.prototype,"textColor",void 0),q([o.property({type:ie}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.Draw")],t)}(l),oe=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.initSketch=function(){var e=this;this.graphics=new p({listMode:"hide"}),this.view.map.add(this.graphics),this.sketch=new x({view:this.view,container:"selectWidget",layer:this.graphics,creationMode:"single"}),this.sketch.viewModel.updateOnGraphicClick=!1,this.sketch.on("create",(function(t){var i;"complete"===t.state&&e.graphics.removeAll(),"start"===t.state&&(null===(i=null==ye?void 0:ye.measurement)||void 0===i||i.clear())})),this.sketch.watch("activeTool",(function(e){var t;null!=e&&(null===(t=null==ye?void 0:ye.measurement)||void 0===t||t.clear())}))},t.prototype.init=function(e){console.log(e.scale),this.set("bufferDistance",0)},q([o.property()],t.prototype,"view",void 0),q([o.property()],t.prototype,"layer",void 0),t=q([o.subclass("app.widgets.Select.SelectViewModel")],t)}(s),ne="esri-widget select-base",le=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new oe,i._sketchCreated=function(){i.viewModel.sketch||i.viewModel.initSketch()},i}return _(t,e),t.prototype.handleChange=function(e){this.set("bufferDistance",parseInt(e.target.value))},t.prototype.render=function(){var e,t=this;return null===(e=document.querySelector("#selectDiv calcite-input"))||void 0===e||e.addEventListener("calciteInputBlur",(function(e){t.handleChange(e)})),n.tsx("div",{class:ne},n.tsx("div",{afterUpdate:this._sketchCreated,id:"selectWidget"}),n.tsx("calcite-label",{scale:"s"},"Buffer Distance (feet)",n.tsx("calcite-input",{scale:"s",type:"number",min:"0",max:"2000",step:"50",value:this.viewModel.bufferDistance})))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.layer")],t.prototype,"layer",void 0),q([o.aliasOf("viewModel.sketch")],t.prototype,"sketch",void 0),q([o.aliasOf("viewModel.bufferDistance")],t.prototype,"bufferDistance",void 0),q([o.property({type:oe}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.Select")],t)}(l),se=function(e){function t(t){var i=e.call(this,t)||this;return i.changePropertyLines=function(e){var t=i.view.map.allLayers.find((function(e){return"feature"===e.type&&"Property"===e.title})),r=t.renderer.clone();e.title.toLowerCase().includes("dark")||e.title.toLowerCase().includes("night")||e.title.toLowerCase().includes("dark")||e.portalItem.description.toLowerCase().includes("dark")||e.title.toLowerCase().startsWith("20")||e.title.toLowerCase().startsWith("19")?r.symbol.outline.color=new O([255,255,255,.25]):r.symbol.outline.color=new O([0,0,0,.25]),t.renderer=r},i.toggleContent=function(e){var t,i,r,a,o,n,l,s,c,d,u;"maps"===e?(null===(t=document.querySelector("#maps"))||void 0===t||t.classList.remove("hidden"),null===(i=document.querySelector("#images"))||void 0===i||i.classList.add("hidden"),null===(r=document.querySelector("#mapsItem"))||void 0===r||r.setAttribute("checked",""),null===(a=document.querySelector("#imagesItem"))||void 0===a||a.removeAttribute("checked"),null===(o=document.querySelector("#blend"))||void 0===o||o.classList.add("hidden"),null===(n=document.querySelector("#blendSlider"))||void 0===n||n.classList.add("hidden")):(null===(l=document.querySelector("#images"))||void 0===l||l.classList.remove("hidden"),null===(s=document.querySelector("#maps"))||void 0===s||s.classList.add("hidden"),null===(c=document.querySelector("#imagesItem"))||void 0===c||c.setAttribute("checked",""),null===(d=document.querySelector("#mapsItem"))||void 0===d||d.removeAttribute("checked"),null===(u=document.querySelector("#blend"))||void 0===u||u.classList.remove("hidden"))},y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.init=function(e){var t=this;this.basemaps=new A({view:this.view}),this.changePropertyLines(this.view.map.basemap),this.view.map.watch("basemap",(function(e){var i,r,a;t.changePropertyLines(e),(null===(i=document.querySelector("#images"))||void 0===i?void 0:i.classList.contains("hidden"))&&(t.activeBasemap.baseLayers.forEach((function(e){console.log("remove"),t.view.map.remove(t.view.map.findLayerById(e.id))})),t.activeBasemap=t.view.map.basemap,null===(r=document.querySelector("#blendSwitch"))||void 0===r||r.removeAttribute("switched")),t.images.viewModel.items.find((function(e){return e.basemap.title===t.view.map.basemap.title}))&&(null===(a=document.querySelector("#blendSwitch"))||void 0===a?void 0:a.hasAttribute("switched"))?t.view.map.addMany(t.activeBasemap.baseLayers.toArray()):t.activeBasemap.baseLayers.forEach((function(e){console.log("remove"),t.view.map.remove(t.view.map.findLayerById(e.id))}))})),this.activeBasemap=this.view.map.basemap,this.images=new A({view:this.view,source:{query:{id:"492386759d264d49948bf7f83957ddb9"}}}),window.addEventListener("pagehide",(function(){t.activeBasemap.baseLayers.forEach((function(e){console.log("remove"),t.view.map.remove(t.view.map.findLayerById(e.id))}));var i=e.map.toJSON();i.initialState.viewpoint.targetGeometry=e.extent,window.localStorage.setItem("imaps",JSON.stringify(i))}))},q([o.property()],t.prototype,"view",void 0),t=q([o.subclass("app.widgets.BaseMaps.BaseMapsViewModel")],t)}(s),ce="esri-widget basemaps-base",de=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new se,i._createMaps=function(){i.basemaps&&(i.basemaps.container="maps")},i._createImages=function(){i.images&&(i.images.container="images")},i.handleSwitchChange=function(e){var t,r;""!=e.target.getAttribute("switched")?(null===(t=document.querySelector("#blendSlider"))||void 0===t||t.classList.remove("hidden"),console.log("add"),i.view.map.addMany(i.viewModel.activeBasemap.baseLayers.toArray(),0),i.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!1})),i.view.map.layers.filter((function(e){return i.viewModel.activeBasemap.baseLayers.includes(e)})).forEach((function(e){e.opacity=.5,e.visible=!0}))):(null===(r=document.querySelector("#blendSlider"))||void 0===r||r.classList.add("hidden"),i.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!0})),i.viewModel.activeBasemap.baseLayers.forEach((function(e){console.log("remove"),i.view.map.remove(i.view.map.findLayerById(e.id))})))},i.handleSliderChange=function(e){i.view.map.layers.filter((function(e){return i.viewModel.activeBasemap.baseLayers.includes(e)})).toArray().forEach((function(t){t.opacity=parseFloat(e.target.getAttribute("value"))}))},i._sliderCreated=function(e){var t;null===(t=document.querySelector("#blendSlider"))||void 0===t||t.addEventListener("calciteSliderUpdate",i.handleSliderChange.bind({basemap:i.basemaps,view:i.view}))},i._blendCreated=function(e){var t,r;null===(t=document.querySelector("#blendSwitch"))||void 0===t||t.addEventListener("calciteSwitchChange",i.handleSwitchChange.bind({basemap:i.basemaps,view:i.view})),null===(r=document.querySelector("#blend"))||void 0===r||r.removeAttribute("switched")},i}return _(t,e),t.prototype.render=function(){var e=this;return document.querySelectorAll("#basemapDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r;(null===(i=t.target)||void 0===i?void 0:i.checked)&&e.viewModel.toggleContent(null===(r=t.target)||void 0===r?void 0:r.value)}))})),n.tsx("div",{class:ce},n.tsx("label",{class:"hidden",id:"blend"},n.tsx("calcite-switch",{afterCreate:this._blendCreated,id:"blendSwitch"})," Blend"),n.tsx("calcite-slider",{afterCreate:this._sliderCreated,class:"hidden",id:"blendSlider",value:"0.5",max:"1",min:"0",step:"0.1"}),n.tsx("div",{afterCreate:this._createMaps,id:"maps"}),n.tsx("div",{afterCreate:this._createImages,id:"images",class:"hidden"}),n.tsx("calcite-radio-group",{width:"full"},n.tsx("calcite-radio-group-item",{checked:!0,value:"maps",id:"mapsItem"},"Maps"),n.tsx("calcite-radio-group-item",{value:"images",id:"imagesItem",disabled:!0},"Imagery")))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.basemaps")],t.prototype,"basemaps",void 0),q([o.aliasOf("viewModel.images")],t.prototype,"images",void 0),q([o.property({type:se}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.BaseMaps")],t)}(l),ue=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.init=function(e){console.log(e.scale),this.layerList=new I({view:e,container:"layerDiv",listItemCreatedFunction:function(t){var i=t.item;if("group"!=i.layer.type){var r=document.createElement("calcite-slider");r.setAttribute("min","0"),r.setAttribute("max","100"),r.setAttribute("min-label","0%"),r.setAttribute("max-label","100%"),r.setAttribute("label-handles",""),r.setAttribute("value",(100*(null==i?void 0:i.layer.opacity)).toString()),r.setAttribute("data",i.layer.id),r.addEventListener("calciteSliderUpdate",(function(t){var i;e.map.findLayerById(t.target.getAttribute("data")).opacity=parseInt(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.getAttribute("value"))/100})),i.panel={content:[r,"legend"],open:!1},"Property"===i.layer.title&&(i.actionsSections=[[{title:"Show Labels",type:"toggle",id:"property-labels",value:i.layer.labelsVisible}]])}}}),this.layerList.on("trigger-action",(function(e){"property-labels"===e.action.id&&(e.item.layer.labelsVisible=e.action.value)}))},q([o.property()],t.prototype,"view",void 0),t=q([o.subclass("app.widgets.Layers.LayersViewModel")],t)}(s),pe="esri-widget layers-base",ve=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new ue,i._createLayers=function(){i.layerList&&(i.layerList.container="layers")},i}return _(t,e),t.prototype.render=function(){return n.tsx("div",{class:pe},n.tsx("div",{afterCreate:this._createLayers,id:"layers"}))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.layerList")],t.prototype,"layerList",void 0),q([o.property({type:ue}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.Layers")],t)}(l),fe=function(e){function t(t){var i=e.call(this,t)||this;return y.whenDefinedOnce(i,"view",i.init.bind(i)),i}return _(t,e),t.prototype.init=function(e){this.search=new c({view:e,maxSuggestions:30,searchAllEnabled:!1}),this.search.allSources.on("after-add",(function(e){e.item.layer&&(e.item.name=e.item.layer.title,e.item.placeholder=e.item.layer.title)}))},q([o.property()],t.prototype,"view",void 0),t=q([o.subclass("app.widgets.LocationSearch.LocationSearchViewModel")],t)}(s),me="esri-widget locationsearch-base",he=function(e){function t(t){var i=e.call(this,t)||this;return i.viewModel=new fe,i._searchCreate=function(){i.search&&(i.search.container="locationSearch")},i}return _(t,e),t.prototype.render=function(){return n.tsx("div",{class:me},n.tsx("div",{afterCreate:this._searchCreate,id:"locationSearch"}))},q([o.aliasOf("viewModel.view")],t.prototype,"view",void 0),q([o.aliasOf("viewModel.search")],t.prototype,"search",void 0),q([o.property({type:fe}),n.renderable()],t.prototype,"viewModel",void 0),t=q([o.subclass("app.widgets.LocationSearch")],t)}(l),ye=new G,we=new le,be=new ae;function ge(e,t){"Search"!==e||te||(te=new W({view:t,condosTable:H,addressTable:z,propertyLayer:V,container:"sideDiv"})),"Layers"!==e||K||(K=new ve({view:t,container:"layersDiv"})),"Legend"!==e||Y||(Y=new i({view:t,container:"legendDiv"})),"Print"!==e||ee||(ee=new r({view:t,container:"printDiv",printServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"})),"Bookmarks"!==e||Q||(Q=new a({view:t,container:"bookmarkDiv",editingEnabled:!0})),"Basemaps"!==e||X||(X=new de({view:t,container:"basemapDiv"})),"Location"!==e||Z||(Z=new he({view:t,container:"locationDiv"}))}var Se=function(e){document.querySelectorAll(".panel").forEach((function(t){t.title!=e?t.classList.add("hidden"):(t.removeAttribute("dismissed"),window.outerWidth<500?t.setAttribute("style","min-width: calc(100% - 50px)"):t.setAttribute("style","min-width: 350px"),t.classList.remove("hidden"),"Measure"!=t.title||ye.measureOpened())}))},Ee=document.querySelectorAll("calcite-action");null==Ee||Ee.forEach((function(e){null==e||e.addEventListener("click",(function(t){Se(t.target.text),ge(t.target.text,xe),Ee.forEach((function(e){e.removeAttribute("active")})),e.toggleAttribute("active")}))}));var De,Oe,xe=new M({container:"viewDiv",map:F});xe.when((function(){xe.map.allLayers.forEach((function(e){"group"!=e.type?e.watch("visible",(function(t){var i;null===(i=K.layerList)||void 0===i||i.operationalItems.forEach((function(i){if("group"===i.layer.type){var r=i.children.find((function(t){return t.layer===e}));r&&(r.panel.open=t)}}))})):e.watch("visible",(function(t){var i=K.layerList.operationalItems.find((function(t){return t.layer===e}));i&&(i.open=t)}))}));var e=F.allLayers.find((function(e){return"Property"===e.title&&"feature"===e.type}));xe.on("hold",(function(e){te.geometry=e.mapPoint,Se("Search")})),xe.whenLayerView(e).then((function(){te.propertyLayer=e,we.viewModel.sketch.on("create",(function(e){var t;if("complete"===e.state){if((null===(t=we.viewModel)||void 0===t?void 0:t.bufferDistance)>0){var i=C.geodesicBuffer(e.graphic.geometry,we.viewModel.bufferDistance,"feet");te.geometry=i,e.graphic.geometry=i,we.viewModel.graphics.add(e.graphic),e.graphic.symbol={type:"simple-fill",style:"none",outline:{style:"short-dash",width:2.5,color:[221,221,221,1]},color:[255,243,13,.25]},xe.goTo(e.graphic)}else te.geometry=e.graphic.geometry;Se("Search")}}))})).catch((function(e){console.log(e),function(e,t){var i;null===(i=document.querySelector("calcite-alert"))||void 0===i||i.remove();var r=document.createElement("calcite-alert"),a=document.createElement("div");a.setAttribute("slot","alert-message"),a.innerHTML=e,r.setAttribute("color",t),r.setAttribute("active",""),r.setAttribute("icon",""),r.appendChild(a),document.body.appendChild(r)}("Property layer did not load. Please contact iMAPS Help Desk.","red")}))})),xe.when((function(e){var t=new w({view:e}),i=new b({content:t,mode:"floating",expandIconClass:"esri-icon-pan2"});e.ui.add(i,"bottom-left"),e.ui.add(new S({view:e}),"top-left");var r=new E({view:e});r.on("locate-error",(function(e){console.log(e)})),e.ui.add(r,"top-left");var a=new D({view:e});return a.on("track-error",(function(e){console.log(e)})),e.ui.add(a,"top-left"),ye.view=e,ye.container="measureDiv",be.view=e,be.container="drawDiv",we.container="selectDiv",we.view=e,we.layer=V,e})),xe.when((function(){document.querySelectorAll(".tip").forEach((function(e){e.addEventListener("click",(function(){var t,i,r,a,o,n,l;null===(t=document.querySelector("calcite-tip-manager"))||void 0===t||t.remove(),null===(r=null===(i=e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r||r.removeAttribute("dismissed"),null===(o=null===(a=e.parentElement)||void 0===a?void 0:a.parentElement)||void 0===o||o.classList.remove("hidden");var s=document.createElement("calcite-tip-manager");s.setAttribute("theme",N);var c=P.find((function(t){return t.panel.name===e.id})),d=document.createElement("calcite-tip-group");d.setAttribute("text-group-title",null===(n=c)||void 0===n?void 0:n.panel.title),s.appendChild(d),null==c||c.panel.tips.forEach((function(e){var t=document.createElement("calcite-tip");t.setAttribute("heading",e.title);var i=document.createElement("p");i.innerHTML=e.message,t.appendChild(i),d.appendChild(t)})),null===(l=null===document||void 0===document?void 0:document.body)||void 0===l||l.appendChild(s)}))}))})),window.addEventListener("pagehide",(function(){xe.map.removeMany(xe.map.allLayers.filter((function(e){return"group"===e.type&&!e.layers.length})).toArray());var e=xe.map.toJSON();e.initialState.viewpoint.targetGeometry=xe.extent,window.localStorage.setItem("imaps",JSON.stringify(e))})),window.outerWidth>=500&&(null===(De=document.querySelector("calcite-panel"))||void 0===De||De.classList.remove("hidden"),null===(Oe=document.querySelector("calcite-panel"))||void 0===Oe||Oe.removeAttribute("dismissed")),xe.when((function(){document.querySelectorAll("calcite-panel").forEach((function(e){e.addEventListener("calcitePanelDismissedChange",(function(e){var t,i;window.outerWidth<=500&&(e.target.dismissed?null===(t=document.querySelector("#viewDiv"))||void 0===t||t.classList.remove("below"):null===(i=document.querySelector("#viewDiv"))||void 0===i||i.classList.add("below")),e.target.dismissed&&Ee.forEach((function(e){e.removeAttribute("active")}))}))})),ge("Search",xe),document.querySelectorAll("calcite-action").forEach((function(e){e.removeAttribute("disabled")}))})),document.querySelectorAll("calcite-panel div").forEach((function(e){"header-trailing-content"===e.slot&&e.setAttribute("style","display: flex; flex-direction: row;")})),window.onresize=function(){var e;(null===(e=null===event||void 0===event?void 0:event.target)||void 0===e?void 0:e.outerWidth)>=500?document.querySelectorAll("calcite-panel").forEach((function(e){var t;"minimize"===(null===(t=e.querySelector(".maximize"))||void 0===t?void 0:t.getAttribute("icon"))?e.setAttribute("style","min-width: calc(100% - 50px)"):e.setAttribute("style","min-width: 350px")})):document.querySelectorAll("calcite-panel").forEach((function(e){e.getAttribute("dismissed")?e.setAttribute("style","min-width: 0px"):e.setAttribute("style","min-width: calc(100% - 50px)")}))},document.querySelectorAll("calcite-panel").forEach((function(e){e.addEventListener("calcitePanelDismissedChange",(function(){document.querySelectorAll("calcite-panel").forEach((function(e){e.setAttribute("style","min-width: 0px"),document.querySelectorAll(".maximize").forEach((function(e){e.setAttribute("icon","maximize")}))}))}))})),document.querySelectorAll(".maximize").forEach((function(e){e.addEventListener("click",(function(){var t,i,r,a,o,n,l,s;null===(i=null===(t=e.parentElement)||void 0===t?void 0:t.parentElement)||void 0===i||i.removeAttribute("dismissed"),null===(a=null===(r=e.parentElement)||void 0===r?void 0:r.parentElement)||void 0===a||a.classList.remove("hidden"),"maximize"===e.getAttribute("icon")?(e.setAttribute("icon","minimize"),null===(n=null===(o=e.parentElement)||void 0===o?void 0:o.parentElement)||void 0===n||n.setAttribute("style","min-width: calc(100% - 50px)")):"minimize"===e.getAttribute("icon")&&(e.setAttribute("icon","maximize"),null===(s=null===(l=e.parentElement)||void 0===l?void 0:l.parentElement)||void 0===s||s.setAttribute("style","min-width:350px"))}))})),function(){var e;if(null===(e=document.querySelector("calcite-dropdown"))||void 0===e||e.addEventListener("calciteDropdownSelect",(function(e){e.target.querySelectorAll("calcite-dropdown-item").forEach((function(e){if(e.hasAttribute("active")){var t=e.getAttribute("value");k(N=t),window.localStorage.setItem("theme",N)}}))})),window.localStorage.getItem("theme")){var t=window.localStorage.getItem("theme");k(t),t="light"===t?"dark":"light",document.querySelectorAll("calcite-dropdown-item").forEach((function(e){if(e.hasAttribute("active")){e.getAttribute("value")!=t&&e.removeAttribute("active");var i=e.getAttribute("value");N=i}else e.getAttribute("value")===t&&e.setAttribute("active","")}))}}(),e.view=xe,Object.defineProperty(e,"__esModule",{value:!0})}));
